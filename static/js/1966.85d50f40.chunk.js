"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[1966],{71966:function(n,e,t){t.r(e),t.d(e,{default:function(){return D}});var a=t(72489),r=t(15489),o=t(87831),s=t(19565),c=t(8135),i=t(56495),u=t(63114),l=t(78738),f=t.n(l),p=t(15344),d=t(14827),g=t(4670),v=t(23818),m="container_do0RY",h="selected-tags_oQIy4",x="passages-container_QzkDw",Z="passage-operations_n7Wko",j="pagination_XtSvB";function w(n){return k.apply(this,arguments)}function k(){return(k=(0,c.Z)((0,s.Z)().mark((function n(e){return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("http:"!==window.location.protocol){n.next=3;break}return console.info("\u6d4b\u8bd5\u73af\u5883\u4e0d\u652f\u6301\u590d\u5236"),n.abrupt("return");case 3:return n.next=5,navigator.clipboard.writeText(e);case 5:return n.abrupt("return",n.sent);case 6:case"end":return n.stop()}}),n)})))).apply(this,arguments)}var N=t(10981),b={pageNo:1,pageSize:24,pageCount:1},C=function(n){var e=n.onEnterPassage,t=n.catalogue,o=(0,r.gz)(b),l=(0,u.Z)(o,2),k=l[0],C=k.pageNo,y=k.pageSize,M=k.pageCount,z=l[1],T=(0,r.s0)(),_=(0,r.e0)(),O=_.onReplaceTags,R=_.onRemoveTag,S=_.tags,E=(0,a.useMemo)((function(){var n=Object.values(t||{});return z({pageCount:Math.ceil(n.length/y)}),n.slice(y*(C-1),y*C).map((function(n){return(0,i.Z)((0,i.Z)({},n),{},{mdate:f()(n.mdate).format("YYYY-MM-DD HH:mm:ss")})}))}),[t,z,y,C]),I=function(n){null===e||void 0===e||e(n),T("/passage/".concat(n["json-path"]))},Y=function(){var n=(0,c.Z)((0,s.Z)().mark((function n(e){return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,w("".concat(window.location.protocol,"//").concat(window.location.host,"/#/passage/").concat(e["json-path"]));case 2:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}();return(0,N.jsxs)("div",{className:m,children:[!!S.length&&(0,N.jsxs)(d.Z,{className:h,variant:"outlined",children:[null===S||void 0===S?void 0:S.map((function(n){return(0,N.jsx)(v.Vp,{selected:!0,onRemove:function(){return R(n)},children:n})})),(0,N.jsx)(g.Z,{size:"small",color:"primary",onClick:function(){return O([])},children:"\u6e05\u9664"})]}),(0,N.jsx)("div",{className:x,children:E.map((function(n){return(0,N.jsx)(v.Zb,{onClickImage:function(){return I(n)},title:n.title,headerImage:n.cover,extraInfo:(0,N.jsx)("div",{children:n.tags.map((function(n){return(0,N.jsx)(v.Vp,{children:n},n)}))}),extraInfoHover:n.mdate,hoverContent:(0,N.jsxs)("div",{className:Z,children:[(0,N.jsx)(v.JO,{className:"rp-faxian",text:"\u9605\u8bfb",onClick:function(){return I(n)}}),(0,N.jsx)(v.JO,{className:"rp-fuzhi",text:"\u590d\u5236",onClick:function(){return Y(n)}})]})})}))}),(0,N.jsx)("div",{className:j,children:(0,N.jsx)(p.Z,{count:M,page:C,onChange:function(n,e){z({pageNo:e})}})})]})},y=t(86213),M=t(575),z="tags-pool_DOAPN",T="tags_KNxsG",_=function(n){var e=n.tags,t=(0,a.useState)(!1),o=(0,u.Z)(t,2),s=o[0],c=o[1],l=(0,r.e0)(),f=l.onSelectTag,p=l.onRemoveTag,g=l.tags;return(0,a.useLayoutEffect)((function(){setTimeout((function(){c(!0)}),3e3)}),[]),(0,N.jsxs)(d.Z,{className:z,variant:"outlined",children:[(0,N.jsx)(M.Z,{variant:"h3",children:"Tags"}),(0,N.jsx)("div",{className:T,children:Array.from(e).map((function(n,e){var t=(0,u.Z)(n,2),a=t[0],r=t[1];return(0,N.jsx)(y.Z,(0,i.Z)((0,i.Z)({in:s,style:{transformOrigin:"0 0 0"}},s?{timeout:100*e}:{}),{},{children:(0,N.jsxs)(v.Vp,{selected:g.includes(a),onClick:function(){return f(a)},onRemove:function(){return p(a)},children:[a,"(",r.length||0,")"]})}),a)}))})]})},O=t(99641),R=t(14929),S={tagsMap:new Map,catalogue:{}};function E(){var n=(0,r.il)(R.Z),e=(0,u.Z)(n,3),t=e[0],o=e[1],l=e[2],f=(0,r.e0)().tags,p=(0,r.gz)(S),d=(0,u.Z)(p,2),g=d[0],v=d[1],m=(0,r.tG)((function(n){return Object.keys(n).reduce((function(e,t){var a,r=n[t];return 0===f.length||null!==(a=r.tags)&&void 0!==a&&a.some((function(n){return f.includes(n)}))?(0,i.Z)((0,i.Z)({},e),{},(0,O.Z)({},t,r)):e}),{})}));return(0,r.bd)((0,c.Z)((0,s.Z)().mark((function n(){var e,a,r;return(0,s.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,t();case 2:e=n.sent,a=e.data,r=new Map,Object.values(a).reduce((function(n,e){var t=e.tags;return(void 0===t?[]:t).forEach((function(t){var a=n.get(t)||[];a.push(e),n.set(t,a)})),n}),r),v({tagsMap:r,catalogue:m(a)});case 7:case"end":return n.stop()}}),n)}))),[f.join(","),m,v]),(0,a.useEffect)((function(){var n=(null===o||void 0===o?void 0:o.data)||{};v({catalogue:m(n)})}),[m,null===o||void 0===o?void 0:o.data,v]),(0,i.Z)({loading:l},g)}var I="catalogue_vrzmA",Y=function(){var n=(0,r.Gm)().setStates,e=E(),t=e.catalogue,s=e.tagsMap;return(0,a.useEffect)((function(){null===n||void 0===n||n({title:o.TN})}),[n]),(0,N.jsxs)("div",{className:I,children:[(0,N.jsx)(_,{tags:s}),(0,N.jsx)(C,{catalogue:t})]})},D=(0,a.memo)(Y)},14929:function(n,e,t){t.d(e,{Z:function(){return c}});var a=t(19565),r=t(8135),o=t(73568),s=t.n(o);function c(){return i.apply(this,arguments)}function i(){return(i=(0,r.Z)((0,a.Z)().mark((function n(){return(0,a.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,s().get("/md/catalogue.json");case 2:return n.abrupt("return",n.sent);case 3:case"end":return n.stop()}}),n)})))).apply(this,arguments)}}}]);