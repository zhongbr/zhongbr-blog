---
title: 'UDP协议'
tags: ['计算机网路','传输层','UDP']
---
# UDP协议（用户数据报协议）

在IP数据报的基础上增加了复用、分用和差错检测功能。

## 特点

1. UDP是无连接的，减少开销和发送数据之前的时延
2. UDP使用最大努力交付，不保证可靠传输
3. UDP面向报文的，适合一次传输少量的数据的网路应用
4. UDP无拥塞控制，适合很多实时应用
5. UDP首部较小，只有8字节，而TCP由20字节

*****

## 首部格式

![截屏 2020-08-11 下午3.46.50.png](https://i.loli.net/2020/08/11/bK9dC8JDFWrNAhY.png)

- UDP长度：UDP用户数据的整个长度
- UDP校验和：检测整个UDP数据报是否有错，有错就丢弃

分用时，找不到对应的目的端口号，就丢弃报文，并给发送方发送ICMP“端口不可达”差错报文。

*****

## UDP校验

![截屏 2020-08-11 下午3.51.18.png](https://i.loli.net/2020/08/11/Nj7qpYuHRXV9fyl.png)

- 伪首部只有在计算校验的时候才会出现，不向下传送又不向上递交。

### 发送端

1. 添加伪首部
2. 全0填充校验和字段
3. 全0将数据部分填充为4B的整数倍
4. 伪首部+首部+数据部分，然后二进制反码求和
5. 求和得到的反码填入校验和字段
6. 去掉伪首部，发送

### 接收端

1. 填上伪首部
2. 伪首部 + 首部 + 数据 二进制反码求和
3. 如果求和的结果全为1，则无差错，否则丢弃数据报，或者不丢弃数据报，在交给应用层的时候附加出错的警告。
