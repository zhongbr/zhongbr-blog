---
title: '介质划分和信道访问控制'
tags: ['计算机网络','信道']
---
# 介质划分和信道访问控制

## 点对点链路

两个相邻的结点之间没有第三者，通过一个链路相连

应用：PPP协议、常用于广域网

## 广播式链路

所有主机共享通信介质

应用：早期的总线以太网、无线局域网，常用于局域网

拓扑结构：总线型、星型（逻辑总线型）

## 介质访问控制

### 静态划分信道

信道划分介质访问控制：将使用介质的每个设备与来自同一信道上的其他设备的通信隔离开，把时域和频域资源合理地分配给网络上的设备。

#### 频分多路复用(FDM)

用户在分配到一个频带后，自始至终都占用着这个频带。频分复用的用户在同样的事件占用不同的带宽（频率带宽: $Hz$ ）资源。

##### 优点

- 充分利用传输介质的带宽，系统的效率较高
- 技术成熟，实现容易

#### 时分多路复用(TDM)

将时间划分为等长的时分复用帧（TDM帧）。每一个时分复用用户在每一个时分复用帧中占用固定序号的时隙，所有用户轮流占用信道。

##### 统计时分复用(STDM)

STDM帧不是固定分配时隙，而是按需要动态分布时隙。
各个用户有数据要发送时，将数据发送给集中器的缓存，集中器按照顺序扫描缓存，把缓存中的数据放入STDM中，一个STDM满了就发出。

#### 波分多路复用(WDM)

波分多路复用就是光的频分多路复用，在光线内传输不同波长的光信号，由于光的波长不同，各路光信号互不干扰，最后用波长分解复用器将各路波长分解出来。

#### 码分多路复用(CDM)

码分多址（CDMA）是码分复用的一种方式。

一个比特分为多个码片/芯片（chip），每个站点被指定一个唯一的m位芯片序列。

发送1时，发送站点的码片序列；发送0时，发送站点码片序列的反码。

多个站点同时发送时，各个站点的数据在信道中线性相加。

为了保证可以分离出各路信号，各个站点的码片需要保证正交。

> 正交：用S表示A站点的码片序列，T表示B站点的码片序列，若S和T的规格化内积(Inner Product)为0，即 $S·T=\frac{1}{m}\sum^{m}_{i=1}S_{i}T_{i}=0$ 。

码片向量和该码片向量自身的规格化内积为+1‘码片向量和该码片向量的反码的规格化内积为-1 。

### 动态划分信道

#### 轮询访问介质控制

既不发生冲突、也可以在发送时占有全部带宽

##### 轮询协议

主结点轮流邀请从属结点发送数据

缺点：

- 轮询开销
- 等待延迟
- 单点故障：主结点故障

##### 令牌传递协议

![PNG图像.png](https://i.loli.net/2020/08/08/XQkKUOsaFWlYh9n.png)

令牌：一个特殊格式的MAC控制帧，不包含任何信息，控制信道的使用，确保一个时刻只有一个结点使用信道。

每个结点都可以在持有令牌的有限的时间内发送数据

缺点：

- 令牌开销
- 等待延迟
- 单点故障

#### 随机访问介质控制

##### ALOHA协议

所有用户可以随机发送信息，并且发送时可以占用全部带宽。

###### 纯ALOHA协议

协议思想：不监听信道，不按时间槽发送，随机重发

冲突检测：如果发生冲突，接收方会检测出差错，然后不予确认，发送方在一定时间内收不到确认帧，就会判断发生冲突。

冲突解决：判断发生冲突后随机选择一个时间再重传

对于纯ALOHA协议，其信道**利用率约为0.184**。

###### 时隙ALOPHA协议

协议思想：把时间分成若干个相同的时间片，所有用户再时间开始时刻接入网络信道，若发生冲突，必须等到下一个时间片开始时刻发送。

 $通信负载=\frac{单位时间发送时隙数}{单位时间内时隙总数}$ 

- 纯ALOHA协议比时隙ALOHA协议吞吐量更低，效率更低
- 纯ALOHA协议想发就发，但是时隙ALOHA协议需要等到时间片开始的时刻才可以发送

##### CSMA协议（载波监听多路访问协议）

CS：载波监听：每一个站点发送数据之前都会检测一下总线上是否有其他计算机在发送数据。

MA：多点接入：表示计算机以多点接入的方式连接在一根总线上

协议思想：发送帧之前监听信道

- 信道空闲：将帧完整发送
- 信道繁忙：推迟发送

1. 1-坚持CSMA：忙则一直监听，直到空闲时马上传输，如果有冲突（一段时间内未收到肯定回复），等待一个随机的时间再监听，重复上述过程。
  - 优点：只要媒体空闲，站点就马上发送，避免了媒体利用率损失
  - 缺点：假如有两个或两个以上的站点有数据要发送，冲突不可避免

2. 非坚持CSMA：忙则等待一个随机的时间后再进行监听
  - 优点：采用随机的重发延迟时间可以减少发生冲突的可能性
  - 缺点：可能大家都在随机等待，导致信道上没有人传输，降低信道的使用率

3. p-坚持CSMA：如果一个主机要发送消息，那么它会监听信道，如果信道空闲，以概率p直接传输，不必等待，以概率1-p等到下一个时间槽再传输；如果信道繁忙，就等待一个随机的时间再监听信道。
   - 优点：既可以像非坚持算法一样减少冲突，又能像1-坚持算法那用减少媒体空闲时间
   - 缺点：发生冲突后仍然会坚持把数据发送完，造成浪费

##### CSMA/CD协议（载波监听多点接入/碰撞检测协议 carrier sense multiple access with collision detection）

再发送数据的时候也会监听信道，一旦检测到冲突就会终止数据的发送。

CD：碰撞检测，“边发送边监听”，适配器边发送数据边监听信道上信号电压的变化，以判断自己发送数据时其他站点是否再发送数据。

单程端到端传播时延： $\tau$ 

总线端到端往返传播时延： $2\tau$ 

争用期/冲突窗口/碰撞窗口： $2\tau$ 

###### 截断二进制指数规避算法

1. 确定基本推迟时间为争用期 $2\tau$ 
2. 定义参数k，等于重传次数。不超过10，即 k = min(k, 10)
3. 从整数集合 $[0,1,2,...,2^{k}-1]$ 中随机取出一个数r，重传之前规避 $r*2\tau=2r\tau$ 后，进行重传
4. 如果重传达到16次仍然失败，说明网络太拥挤，认为此帧永远无法正确发出，抛弃此帧并向上层报告出错。

###### 最小帧长

 $\frac{最小帧长}{数据传输速率}\geq 2\tau$ 

以太网规定的最小帧长为64B。长度小于64B的都是因为冲突截止的无效帧

##### CSMA/CA协议（载波监听多点接入/碰撞避免协议 carrier sense multiple access with collision avoidance）

主要用于无线网，CSMA/CD协议的检测碰撞再无线局域网中很难做到，需要 $360\degree$ 检测冲突。

协议思想：发送数据前，检测信道是否是空闲的，如果是空闲的，就发出一个RTS(request to send)，包括发送端地址、接收端地址、下一份数据将持续发送的时间等信息；信道忙则等待。

接收端收到RTS，回复CTS(clear to send)，如果回复了CTS后，其他站点请求给此站点发送RTS，就不会回复CTS。

发送端接收到CTS：开始发送数据帧（同时预约信道：告诉其他站点自己要传多久数据）。
接收端接收到数据帧后，用CRC校验数据是否正确，如果正确就响应一个ACK帧。

发送端接收到ACK就可以进行下一个数据帧的发送，若没有则一直重传直到重发次数成功为止（采用二进制指数退避算法随机确定推迟时间）。

##### CSMA/CD和CSMA/CA的区别

相同点：都是CSMA的思路，其核心是先监听信道，再发送数据、

不同点：

1. 传输介质不同：CSMA/CD常用于总线式以太网【有线】；CSMA/CA用于无线局域网
2. 载波检测方式不同：CSMA/CD检测信道中电压的变化来检测信道是否繁忙，而CSMA/CA采用能量检测（ED）、载波检测（CS）和能量载波混和检测的方式来检测信道空闲。
3. CSMA/CD协议检测冲突，CSMA/CA协议避免冲突，遇到冲突后都会进行有限的重传。
