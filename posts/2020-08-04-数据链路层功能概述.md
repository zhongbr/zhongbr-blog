---
title: '数据链路层功能概述'
tags: ['计算机网络','数据链路层']
---
# 数据链路层功能概述

## 数据链路层的基本概念

结点：主机、路由器

链路：网络中两个结点之间的**物理通道**，链路的主要介质有双绞线、光纤、微波等，分有线链路和无线链路。

数据链路：网络中两个结点之间的**逻辑通道**，把实现控制数据传输协议的硬件和软件加到链路上就构成了数据链路。

帧：链路层的协议数据单元，封装网络层的数据报。

**数据链路层**负责通过一条链路向结点的另一个链路传送数据报。在物理层提供的服务的基础上，向网络层提供服务，最基本的服务是将来源于网络层的数据可靠地传输到相邻结点地目标机网络层。主要作用是加强物理层传输原始比特流的功能，将物理层提供的可能出错的物理连接改造为**逻辑上无差错的数据链路**，使之对网络层表现为一条无差错的链路。

### 数据链路层的功能

1. 为网路层提供服务：无确认无连接服务，有确认无连接服务，有确认面向连接的服务。**有连接的服务一定是有确认的！**
   - 无确认无连接的服务：对丢失的包数据链路层不负责重发，由上层应用负责处理。适用于误码率低的通信通道或实时通信。
   - 有确认无连接的服务：不需要建立连接，但是目的机器收到数据后需要发送回执确认，源机器在一段时间内未收到确认就会重发。适用于误码率较高的通信通道。
   - 有确认有链接的服务：建立数据链路、传输帧、释放数据链路。每一帧都需要确认，才能发送下一帧。适用于对通信要求较高的场合。
2. 链路管理：连接的建立、维持和释放（用于面向连接的服务）。
3. 组帧
4. 流量控制。
5. 差错控制（帧错/位错）。

#### 组帧

在一段数据的前后部分添加头部和尾部，构成一个帧。接收端在收到物理层上交比特流后，就能根据首部和尾部标记，从收到的比特流中识别出帧的开始和结束。

帧同步：接收方应当能从接收到的二进制比特流中区分出帧的起始和终止

帧长：帧开始到帧结束的长度称为帧长

透明传输：不管要传输的数据是什么比特组合，都应该可以在链路上传送。如果传输的数据恰巧和某个控制信息相同的时候，要采取一定的措施，使接收方不会将这样的数据误认为是某种控制信息。这样才能保证数据链路层的传输时透明的。

##### 字符计数法

帧首部使用一个计数字段（第一个字节，8位）来表明帧内的字符数。

缺点：如果帧的计数字段发生错误，会导致出错的帧和后面的帧都出现错误

##### 字符填充法

使用特定的字节（定界符）表示帧的首部和帧的尾部。

适用于：
1. 传输的帧由文本组成时（文本文件内的字符都是从键盘输入的，都是ASCII码）不管从键盘上输入的什么字符都可以放在帧里传过去，即透明传输。

2. 当传送的帧是由非ASCII码的文本文件组成的时候（二进制代码的程序或图像等），就要采用字符填充方法实现透明传输。
   - 在发送的时候添加转义符
   - 在接收的时候移除转义符

##### 零比特填充法

帧的定界符位‘01111110’，在发送端发送数据的时候，扫描整个信息字段，只要出现来连续的5个1就填充一个0

在接收端接收到一个帧的时候，先找到标志字段确定边界，再用硬件对比特流进行删除，发现连续的5个1时就把后面的0删除。

##### 违规编码法

使用编码方式中不会用到的电平方式来作为帧的定界符

#### 差错控制

传输中的差错都是由噪声引起的

1. 由于线路本身电气特性所产生的随机噪声（热噪声），是信道固有的，随机产生的
   解决方案：提高信噪比

2. 外界特定的短暂原因所造成的冲击噪声，是产生差错的主要原因。
   解决方案：通常利用编码技术来解决

差错：

1. 位错：比特位出错1变成0、0变成1
2. 帧错：
   - 帧丢失
   - 帧重复
   - 帧失序

##### 差错控制（比特错）

###### 检错编码

- 奇偶校验码
  n-1位信息元和1位校验码，奇（偶）校验码是指在信息元前面加上一个校验码后，整个比特流的1的个数位奇（偶）数，只能检查出奇数个比特错误，检错能力为50%。
- CRC循环冗余码

  ******************

  发送端发送：
  
  最终发送的数据 = 要发送的数据 << (生成多项式的阶数) + 帧校验序列FCS

  FCS = 要发送的数据 % 生成多项式

  生成多项式有两种表达形式，如下：

  生成多项式： $x^{4}+x^{1}+x^{0} \leftrightarrow 10011$ 

  ******************

  接收端检查：

  把收到的每一个帧都除以相同的生成多项式，检查余数是否为0

##### 纠错编码

- 海明码

数据的链路层的编码针对一组比特，它通过冗余码的技术实现一组二进制比特串在传输过程是否出现了差错。

冗余码：在数据发送之前，先按某种关系附加上一定的冗余位，构成一个符合某一规则的码字后再发送。当要发送的有效数据变化的时候，相应的冗余码也随之改变，使码字遵从不变的规则。接收端根据收到码字是否仍符合原规则，从而判断是否出错。

发现双比特错，纠正单比特错。一个比特位发生错误，就会引起多个海明码发生改变，可以根据改变了的海明码确定发生错误的比特位。

海明不等式： $2^{r} \geq k + r + 1$ ，r为冗余信息位，k位信息位

发送数据：

- 求校验码的位数：根据海明不等式和数据的位数可以求得最小的校验码位数r
- 确定校验码的位置：校验码只能放在2的几次方的位置， $2^{0}(0001)、2^{1}(0010)、2^{2}(0100) ...$ 
- 确定要传输的数据：将海明码 $P_{n}$ 与所有数据在海明码 $P_{n}$ 中1的位置对应数据位也为1的数据异或，令异或的结果为0，可以求得 $P_{n}$ 。

校验数据：

- 根据收到的数据，计算海明码序列 $\\{P_{n}, P_{n-1}..., P_{1}\\}$ ，转换成十进制数即为发生错误的位数。
