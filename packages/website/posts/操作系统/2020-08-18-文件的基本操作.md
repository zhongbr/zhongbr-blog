---
title: '文件的基本操作'
tags: ['操作系统','文件']
---
# 文件的基本操作

## 创建文件(Create系统调用)

### 需要提供的参数

1. 文件所需要的外存空间大小
2. 文件存放的路径
3. 文件名

### 创建文件的过程

1. 在外存中找到文件所需要的磁盘空间
2. 找到目录对应的目录表文件，在目录表文件中创建该文件相关的目录项，包含了文件的文静名、在外存中的位置等信息。

******

## 删除文件（Delete系统调用）

### 需要提供的参数

1. 文件存放的路径
2. 文件名

### 删除文件的过程

1. 系统根据文件的路径找到相应的目录表文件，从目录表中找到对应的目录项
2. 根据目录项中记录的文件在外存的位置，回收文件占用的磁盘块
3. 从目录表删除文件对应的目录项

******

## 打开文件（Open系统调用）

操作系统中，在对文件进行操作之前，要求用户使用open系统调用“打开文件”。

### 需要提供的参数

1. 文件存放的路径
2. 文件名
3. 要对文件进行的操作

### 打开文件的过程

1. 操作系统根据文件存放的路径找到对应的目录表文件
2. 从目录表中找到文件名对应的目录项，并检查用户是否有该**文件的操作权限**
3. 将目录项复制到内存的“打开文件表”中，并将对应表目的编号返回给用户，之后用户**使用打开文件表的编号**来指明要操作的文件。

> 打开文件表存在于操作系统和进程中：
>
> 操作系统中的打开文件表是整个系统中所有进程的**打开文件表的汇总**，记录了“编号、外存地址、打开计数器”等信息，打开计数器记录了当前文件被多少个进程打开，某个进程关闭文件时，打开计数器减一，如果**打开计数器为0**的时候，可以删除对应的表项。
>
> 进程中的打开文件表是进程自己打开的文件的表，记录了“文件名、读写指针、访问权限、系统打开文件表的索引号”等信息

*****

## 关闭文件（Close系统调用）

## 需要提供的参数

1. 文件在打开文件表中的编号

### 关闭文件的过程

1. 将进程的打开文件表对应的表项删除
2. 回收分配给该文件的内存空间等资源
3. 系统打开文件表的打开计数器count-1，若count==0，就删除对应的表项

******

## 读文件（Read系统调用）

在进行读文件系统调用之前**必须先进行打开文件系统调用**，此时在操作系统的打开文件表中已经有要读取的文件的表项了。

### 需要的参数

1. 文件在系统打开文件表中的编号
2. 需要读入多少数据
3. 读入的数据存放在内存的什么位置

### 读取文件的过程

操作系统根据read系统调用时，从读指针指向的系统外存中，将用户指定大小的数据读入用户指定的内存区域。

******

## 写文件（Write系统调用）

在进行写文件系统调用之前，同样需要先调用系统的Open系统调用，此时要写入的文件已经在系统的打开文件表中。

### 需要提供的参数

1. 文件在打开文件表中的编号
2. 要写入的数据大小
3. 要写入的数据在内存中的位置