---
title: '处理机调度'
tags: ['操作系统','进程']
---
# 处理机调度

由于资源有限，无法将用户提供的全部作业都放入到内存中，所以需要确定某一种规则来将作业调入内存。

||任务|时机|发生频率|对进程状态的影响|
|-|-|-|-|-|
|高级调度（作业调度）|从后备队列选择合适的作业调入内存|外存 -> 内存（面向作业）|最低|无 -> 创建态 -> 就绪态|
|中级调度（内存调度）|从挂起队列选择合适的进程调回内存|外存 -> 内存（面向进程）|中等|挂起态 -> 就绪态（阻塞挂起 -> 阻塞）|
|低级调度（进程调度）|从就绪队列选择合适的进程分配处理机资源|内存 -> CPU |最高|就绪态 -> 运行态|

## 高级调度（作业调度）

按照一定的规则，从外存上处于后备队列的作业中挑选一个或者多个作业，给它们分配内存等必要资源，建立相应的进程，使它们获得竞争处理机的权利。

是内存与外存之间的调度，一个作业只调度依次，作业调入的时候会创建相应的PCB，作业调出时才撤销。**高级调度主要是指调入**的问题，因为只有调入的时机需要操作系统确认。调出时必然是作业运行结束了。

## 中级调度（内存调度）

引入了虚拟存储技术之后，可以将暂时不用的进程调至外存等待，等它重新具备了运行条件且内存空闲的时候，再重新调入内存。可以提高内存的利用率和系统的吞吐量。

当一个进程被调到外存等待时，这个进程会进入挂起的状态，**PCB不会被调到外存**，而是常驻内存中，PCB中会记录进程数据在外存中存放的位置、进程状态等信息。操作系统根据内存中的PCB来爆出对各个进程的监控、管理。

被挂起的PCB会放到**挂起队列**中。

中级调度（内存调度）：决定那个**处于挂起状态**的进程重新进入内存。可能会被中级调度多次。

## 低级调度（进程调度）

低级调度（进程调度）：按照某种算法，从就绪队列中选取一个进程，将处理机分配给它。

进程调度时操作系统中最基本的一种调度，在一般的操作系统中都必须配置进程调度。

进程调度的频率很高，一般几十毫秒就会调度一次。

### 可以进程调度的时机

当前正在运行的进程发生以下的两种情况时可以对进程进行调度：

#### 主动放弃处理机

1. 进程正常终止
2. 运行过程中发生异常终止
3. 进程主动请求阻塞

#### 被动放弃处理机

1. 分给进程的时间片用完
2. 有更紧急的事需要处理（如I/O中断）
3. 有优先级更高的进程进入了就绪队列

不能进行进程调度与切换的情况：

1. 在处理中断的过程中。中断处理的过程复杂，与硬件密切相关，很难做到处理中断的过程中进行进程切换
2. 进程在操作系统内核程序临界区中
3. 在原子操作的过程中。原子操作不能中断，要一气呵成

> 临界资源：一段时间内只允许一个进程使用的资源。各进程需要互斥地访问临界资源。
> 内核程序临界区一般是用来访问某种内核数据结构地，比如进程地就绪队列。内核临界区访问地临界资源如果不尽快释放，可能会影响到操作系统地其他管理工作，因此在内核程序临界区期间不能进行调度和切换。
> 普通临界区访问临界资源不会直接影响操作系统内核地管理操作，因此访问普通临界区时可以进行调度和切换。

### 进程地调度方式


