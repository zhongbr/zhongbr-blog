---
title: '调度算法'
tags: ['操作系统','进程']
---
# 调度算法

## 调度算法好坏的评价指标

### CPU利用率

CPU的造价极其昂贵，因此人们会希望让CPU尽可能工作。

CPU利用率：指CPU“忙碌”的时间站总时间的比例

 $利用率=\frac{忙碌的时间}{总时间}$ 

#### 甘特图

用于求多道程序并发执行的情况下的CPU利用率

### 系统吞吐量

系统吞吐量：单位时间内完成作业的数量

 $系统吞吐量=\frac{总共完成了多少道作业}{总共花了多少时间}$ 

### 周转时间

周转时间：从作业**提交给系统**开始到**作业完成**，总共花费的时间。

周转时间包括：

- 作业在外存上等待作业调度（高级调度）的时间
- 进程在就绪队列上等待进程调度的时间（可能发生多次）
- 进程在CPU上执行的时间（可能发生多次）
- 进程等待I/O操作完成的时间（可能发生多次）

作业的周转时间 = 作业完成的时间 - 作业提交的时间

 $平均周转时间 = \frac{各作业周转时间之和}{作业数}$ 

 $带权周转时间=\frac{作业周转时间}{作业实际运行时间}=\frac{作业完成时间-作业提交时间}{作业实际运行时间}$ 

### 等待时间

等待时间：指进程/作业处于等待处理机状态时间之和，等待时间越长，用户满意度越低

对于进程来说，等待时间就是进程建立以后等待被服务的时间之和，在等待I/O完成期间其实进程也是在被服务的，不计入等待时间。

对于作业来说，等待时间还要考虑建立进程之后的等待时间，还要加上作业在外存后背队列中等待的时间。

 $平均等待时间=\frac{所有作业的总等待时间}{作业的数量}$ ，可以用于评价整体性能。

### 响应时间

响应时间：用户从提交请求到首次产生响应所用的时间



*****

## 调度算法

### 先来先服务、短作业优先和高响应比优先算法

|                        算法                         | 规则                              | 可用于作业/进程调度                                     | 抢占                                                         | 优点                               | 缺点                                                         | 饥饿                                                   |
| :-------------------------------------------------: | --------------------------------- | ------------------------------------------------------- | ------------------------------------------------------------ | ---------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------ |
|      先来先服务(First Come First Serve, FCFS)       | 按照作业/进程的到达顺序进行服务   | 先到达后备队列（就绪队列）的作业/进程先得到处理机的处理 | 非抢占                                                       | 公平，实现简单                     | 排在长进程后面的短进程需要等待很长的时间才能被服务，**对短作业不利，对长作业也有利** | 不会                                                   |
|         短作业优先(Shortest Job First, SJF)         | 最短的作业/进程优先得到服务       | 用于作业调度，用于进程调度的时候称为“短进程优先(SPF)”   | SJF和SPF是非抢占式的，也有抢占式的版本：**最短剩余时间**(SRTN, Shortest Remaining Time Next) | “最短的”平均等待时间和平均周转时间 | 对短作业有利，对长作业不利，作业的运行时间是用户提供的，并不一定真实 | 会                                                     |
| 高响应比优先算法(HRRN, Highest Response Ratio Next) | 选择响应比最高的作业/进程为其服务 | 可以用于作业调度、也可以用进程调度                      | 非抢占式                                                     | 综合考虑了等待时间和运行时间       |                                                              | 随着等待时间越大，响应比也会越来越大，所以不会产生饥饿 |

> 在所有的进程可运行的时间相同时，SJF调度算法的平均等待时间、平均周转时间最少
>
> ** $响应比=\frac{等待时间+要求服务时间}{要求服务时间}$ **

### 时间片轮转调度、优先级调度和多级反馈队列调度

| 算法             |                             规则                             | 可用于作业/进程                                            | 抢占                                                | 优点                                                         | 缺点                                                         | 饥饿 |
| ---------------- | :----------------------------------------------------------: | ---------------------------------------------------------- | --------------------------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---- |
| 时间片轮流       | 按照各个进程到达就绪队列的顺序，轮流让各个进程执行一个时间片。**如果时间片太大，会退化成先来先服务去调度**。时间片太小会导致进程切换过于频繁，花大量的时间进行进程切换。 | 用于进程调度，作业只有建立了相应的进程之后才能被分配时间片 | 抢占式。由时钟装置发出时钟中断来通知CPU时间片已到。 | 公平，响应快，适用于分时操作系统                             | 进程切换有一定的开销，且不区分任务的紧急程度                 | 不会 |
| 优先级调度算法   | 为每一个作业/进程设置一个优先级，调度时选择优先级最高的作业/进程 | 既可以用于作业调度，也可以用于进程调度                     | 抢占式、非抢占式                                    | 区分任务的紧急程度，适用于实时操作系统                       | 如果不断地有高优先级地进程到达，可能会导致低优先级地进程饥饿 | 会   |
| 多级反馈队列调度 | 1. 设置多级就绪队列，各级队列优先级从高到低，时间片从小到大；2. 新进程到达时进入第1级队列，如果用完时间片进程还未结束，则进程进入下一级队列地队尾，如果此时已经是最下级地队列，重新放回该队列队尾；3. 第k级为空时，第k+1级队头地进程分配时间片 | 用于进程调度                                               | 抢占式                                              | 对各类进程相对公平；对每个新到达地进程都可以很快响应；段进程只用很少的时间就可以完成；不必实现估计进程的运行时间；可以灵活调整对割各类进程的偏好程度 |                                                              | 会   |

> 设计时间片的大小要让进程切换到时间开销占比不超过1%。

