{"version":3,"file":"static/js/986.a961e140.chunk.js","mappings":"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","sources":["types/markdown.ts","service/passage/passage.ts","container/Passage/components/Render/index.tsx","webpack://react-press/./src/container/Passage/components/Sketch/style.module.less?1d2a","container/Passage/components/Sketch/index.tsx","container/Passage/utils/traverse.ts","webpack://react-press/./src/container/Passage/style.module.less?8629","container/Passage/index.tsx","service/passage/catalogue.ts"],"sourcesContent":["export enum NodeType {\n    Document = 'Document',\n    Header = 'Header',\n    Paragraph = 'Paragraph',\n    CodeBlock = 'CodeBlock',\n    BlockQuote = 'BlockQuote',\n    Table = 'Table',\n    TableRow = 'TableRow',\n    TableCell = 'TableCell',\n    Html = 'Html',\n    Image = 'Image',\n    Link = 'Link',\n    Yaml = 'Yaml',\n    Str = 'Str',\n    Strong = 'Strong',\n    Emphasis = 'Emphasis',\n    List = 'List',\n    ListItem = 'ListItem',\n    HorizontalRule = 'HorizontalRule',\n    Delete = 'Delete'\n}\n\nexport enum Align {\n    Left = 'left',\n    Right = 'right',\n    Center = 'center'\n}\n\nexport interface IPostion {\n    line: number;\n    column: number;\n}\n\nexport type IRange = [number, number];\n\nexport interface ILocation {\n    start: IPostion;\n    end: IPostion;\n}\n\nexport interface Node {\n    key?: string;\n    type: NodeType;\n    children: Node[];\n    loc: ILocation,\n    range: IRange,\n    raw: string;\n    value: string;\n    depth?: number;\n    lang?: string;\n    align?: Align[];\n    ordered?: boolean;\n    spread?: boolean;\n    checked?: unknown;\n    start?: number;\n    title?: string;\n    url?: string;\n    alt?: string;\n    parent?: Node;\n    nextSibling?: Node;\n    previousSibling?: Node;\n}\n\nexport interface IBaseProps {\n    node: Node;\n    children?: React.ReactNode;\n}\n","/*\n * @Description: catalogue\n * @Author: 张盼宏\n * @Date: 2022-08-28 12:52:39\n * @LastEditors: 张盼宏\n * @LastEditTime: 2022-08-28 13:06:44\n */\nimport axios from 'axios';\n\nimport { Node } from '@/types/markdown';\nimport { IPassage } from './catalogue';\n\nexport interface IResp {\n    ast: Node;\n    catalogue: IPassage;\n}\n\nexport default async function getPassageContent(params: { path: string; }) {\n    return await axios.get<IResp>(`/md/${params.path}`);\n}\n","/*\n * @Description: desc\n * @Author: 张盼宏\n * @Date: 2022-08-29 22:40:12\n * @LastEditors: 张盼宏\n * @LastEditTime: 2022-08-29 22:40:12\n */\nimport React, { lazy, memo } from 'react';\n\nimport { NodeType, IBaseProps } from '@/types/markdown';\n\nconst ComponentsMap = new Map([\n    [NodeType.Header, lazy(() => import('./Header'))],\n    [NodeType.Str, lazy(() => import('./Str'))],\n    [NodeType.Strong, lazy(() => import('./Strong'))],\n    [NodeType.Emphasis, lazy(() => import('./Emphasis'))],\n    [NodeType.Delete, lazy(() => import('./Delete'))],\n    [NodeType.Paragraph, lazy(() => import('./Paragraph'))],\n    [NodeType.CodeBlock, lazy(() => import('./CodeBlock'))],\n    [NodeType.BlockQuote, lazy(() => import('./BlockQuote'))],\n    [NodeType.Link, lazy(() => import('./Link'))],\n    [NodeType.Image, lazy(() => import('./Image'))],\n    [NodeType.Html, lazy(() => import('./Html'))],\n    [NodeType.Table, lazy(() => import('./Table'))],\n    [NodeType.TableRow, lazy(() => import('./TableRow'))],\n    [NodeType.TableCell, lazy(() => import('./TableCell'))],\n    [NodeType.Yaml, lazy(() => import('./Yaml'))],\n    [NodeType.List, lazy(() => import('./List'))],\n    [NodeType.ListItem, lazy(() => import('./ListItem'))],\n    [NodeType.HorizontalRule, lazy(() => import('./HorizontalRule'))]\n]);\n\nconst Render: React.FC<IBaseProps> = (props) => {\n    const { node } = props;\n\n    if (!node) {\n        return null;\n    }\n\n    const children = node.children?.map(child => <Render key={child.key} node={child}/>);\n\n    if (node.type === NodeType.Document) {\n        return <>{children}</>;\n    }\n\n    const Component = ComponentsMap.get(node.type);\n    if (!Component) {\n        return <>{children}</>;\n    }\n\n    return (\n        <Component node={node}>\n            {children}\n        </Component>\n    );\n};\n\nexport default memo(Render);\n","// extracted by mini-css-extract-plugin\nexport default {\"container\":\"container_Gs76A\",\"title\":\"title_AfoNg\",\"item\":\"item_RLSwA\",\"sharp\":\"sharp_eXvmU\",\"selected\":\"selected_UPQ8E\"};","/*\n * @Description: desc\n * @Author: 张盼宏\n * @Date: 2022-08-29 22:43:11\n * @LastEditors: 张盼宏\n * @LastEditTime: 2022-08-29 22:43:11\n */\nimport React from 'react';\nimport { Title } from '../../utils/traverse';\nimport styles from './style.module.less';\n\n\nexport interface IProps {\n    sketch: Title[];\n    selected?: string;\n}\n\nconst Sketch: React.FC<IProps> = props => {\n    const { sketch } = props;\n\n    return (\n        <div className={styles.container}>\n            <div className={styles.title}>Catalogue</div>\n            {sketch.map(item => (\n                <div\n                    className={styles.item}\n                    key={item.text}\n                    style={{\n                        marginLeft: `${20 * (item.depth - 1)}px`\n                    }}\n                >\n                    <span className={styles.sharp}>#</span>{item.text}\n                </div>\n            ))}\n        </div>\n    );\n};\n\nexport default Sketch;\n","/*\n * @Description: desc\n * @Author: 张盼宏\n * @Date: 2022-08-29 23:24:09\n * @LastEditors: 张盼宏\n * @LastEditTime: 2022-08-29 23:53:08\n */\nimport { Node, NodeType } from '@/types/markdown';\n\nconst generateKey = (n: number) => String.fromCharCode(...n.toString().split('').map(i => Number('a'.charCodeAt(0) + Number(i))));\n/**\n * Traverse markdown ast to set parent, nextSibling and previousSibling.\n * The unique key of each node will be set, too.\n * */\nexport function traverseAst(node: Node, parent?: Node, scope = '', index = 0) {\n    node.key = `${scope ? scope + '-' : ''}${generateKey(index)}`;\n\n    if (parent) {\n        node.parent = parent;\n    }\n\n    if (!node?.children?.length) {\n        return;\n    }\n\n    for (let i=0; i<node.children.length; i++) {\n        if (node.children[i-1]) {\n            node.children[i].previousSibling = node.children[i-1];\n        }\n        if (node.children[i+1]) {\n            node.children[i].nextSibling = node.children[i+1];\n        }\n        traverseAst(node.children[i], node, node.key, i);\n    }\n}\n\nexport interface Title {\n    text: string;\n    depth: number;\n    key: string;\n}\n/**\n * Parse the catalogue sketch of the passage\n * */\nexport function generateSketch(document: Node) {\n    const res: Title[] = [];\n    const traverse = (node: Node) => {\n        if (node.type === NodeType.Header) {\n            res.push({\n                text: node.raw.replace(/#+\\s*/g, ''),\n                depth: node.depth || 0,\n                key: node.key || '',\n            });\n        }\n        if (node.children?.length) {\n            node.children.forEach(traverse);\n        }\n    };\n    traverse(document);\n    return res;\n}\n","// extracted by mini-css-extract-plugin\nexport default {\"passage-container\":\"passage-container_FGelG\",\"passageContainer\":\"passage-container_FGelG\",\"passage\":\"passage_yFK6h\",\"sketch\":\"sketch_RjCip\"};","/*\n * @Description: passage\n * @Author: 张盼宏\n * @Date: 2022-08-27 23:24:29\n * @LastEditors: 张盼宏\n * @LastEditTime: 2022-08-29 23:13:04\n */\nimport { useEffect, useState, memo } from 'react';\nimport { useParams } from 'react-router-dom';\n\nimport { usePageConfig, useAsyncFn, useAsyncEffect } from \"@/hooks\";\nimport { passage } from '@/service';\n\nimport { Render, Sketch } from './components';\nimport { traverseAst, generateSketch, Title } from './utils/traverse';\nimport styles from './style.module.less';\n\ntype IPageParam = Record<'path', string | undefined>;\n\nconst Passage = () => {\n    const { setStates, rate = 0 } = usePageConfig();\n    const { path } = useParams<IPageParam>();\n\n    const [fetchPassage, res] = useAsyncFn(passage.passage);\n    const [sketch, setSketch] = useState<Title[]>([]);\n\n    useEffect(() => {\n        setStates?.({\n            title: res?.data?.catalogue?.title\n        });\n    }, [setStates, res?.data?.catalogue?.title]);\n\n    useAsyncEffect(async () => {\n        if (!path) {\n            return;\n        }\n        const res = await fetchPassage({ path });\n        // traverse markdown ast and mark the parent and siblings\n        traverseAst(res.data.ast);\n        // generate sketch\n        const sketch = generateSketch(res.data.ast);\n        setSketch(sketch);\n    }, [fetchPassage, path]);\n\n    return (\n        <div className={styles.passageContainer}>\n            <div\n                className={styles.sketch}\n                style={{\n                    top: `${155 - 75 * rate}px`\n                }}\n            >\n                <Sketch sketch={sketch}/>\n            </div>\n            <div className={styles.passage}>\n                {!!res?.data?.ast ? <Render node={res.data.ast}/> : null}\n            </div>\n        </div>\n    );\n}\n\nexport default memo(Passage);\n","/*\n * @Description: catalogue\n * @Author: 张盼宏\n * @Date: 2022-08-28 12:52:39\n * @LastEditors: 张盼宏\n * @LastEditTime: 2022-08-28 13:06:44\n */\nimport axios from 'axios';\n\nexport interface IPassage {\n    title: string;\n    tags: string[];\n    author: string;\n    summary: string;\n    mdate: string;\n    'header-img': string;\n    'json-path': string;\n}\n\nexport interface ICatalogue {\n    [filename: string]: IPassage;\n}\n\nexport default async function getPassagesCatalogue() {\n    return await axios.get<ICatalogue>('/md/catalogue.json');\n}\n"],"names":["NodeType","Align","getPassageContent","params","axios","path","ComponentsMap","Map","Header","lazy","Str","Strong","Emphasis","Delete","Paragraph","CodeBlock","BlockQuote","Link","Image","Html","Table","TableRow","TableCell","Yaml","List","ListItem","HorizontalRule","Render","props","node","children","map","child","key","type","Document","Component","get","memo","sketch","className","styles","item","style","marginLeft","depth","text","generateKey","n","String","fromCharCode","toString","split","i","Number","charCodeAt","traverseAst","parent","scope","index","length","previousSibling","nextSibling","generateSketch","document","res","traverse","push","raw","replace","forEach","Passage","usePageConfig","setStates","rate","useParams","useAsyncFn","passage","fetchPassage","useState","setSketch","useEffect","title","data","catalogue","useAsyncEffect","ast","top","getPassagesCatalogue"],"sourceRoot":""}