---
title: '虚拟内存'
tags: ['操作系统','虚拟内存']
---
# 虚拟内存

虚拟内存技术是一种实现内存扩充的技术。**比交换技术和覆盖技术更先进**。

## 传统的存储管理方式的特征、缺点

传统的存储管理方案：连续分配和非连续分配，很多长期用不到的数据也会占用内存，导致内存的利用率不高。

**一次性**：作业必须一次性全部装入内存后才能开始运行：

- 作业很大的时候，不能全部装入内存，导致大作业无法运行。
- 当大量的作业要求运行的时候，只有少量的作业可以运行，降低系统的并发度。

**驻留性**：一旦作业被装入内存，就会一直驻留在内存中，直至作业运行结束。事实上，在一个时间段内，只需要访问作业的一小部分数据就可以正常运行，导致了内存中主流了大量的、暂时用不到的数据，浪费了宝贵的内存资源。

****

## 高速缓冲技术

> 局部性原理：有**时间局部性和空间局部性**
>
> 计算机的存储结构（由下到上**容量递减、速度递增**）：
>
> - 寄存器
> - 高速缓冲
> - 内存
> - 外存（磁盘、磁带）

高速缓冲技术的思想：将**近期会频繁访问**的数据放到高速的存储器中，**暂时用不到的数据**放在更低速的存储器中。

*****

## 虚拟内存技术

虚拟内存：在操作系统的管理下，在用户看来，似乎有一个比实际内存大得多的内存，这就是虚拟内存。

基于局部性原理，在程序装入内存时，可以将程序中很快会用到的部分装入内存，暂时用不到的部分驻留在外存，就可以让程序开始执行。

在程序执行的过程中，当访问的信息不在内存是，由**操作系统负责将所需要的信息从外存调入内存**，然后继续执行程序。

当内存的容量不足是，由**操作系统负责将内存中暂时用不到的数据换出到外存**中。

### 虚拟内存的容量问题

- 虚拟内存的**最大容量是由计算机的地址结构（CPU的寻址范围）确定**的

- 虚拟内存的实际容量 = min(内存和外存的实际容量之和，CPU的寻址范围)

### 虚拟内存的特征

1. 多次性：无需在作业运行时一次性全部装入内存，而是允许多次调入内存
2. 对换性：在作业运行时无需一直常驻内存，允许在作业运行的时候，将作业换、换出
3. 虚拟性：从逻辑上扩充了内存的容量，使用户实际看到的内存容量远大于内存的实际容量

### 虚拟内存技术的实现

虚拟内存技术需要建立在**离散分配**的内存管理方式基础上。

传统的非连续分配存储管理（使用虚拟内存后）：

- 基本分页存储管理（请求分页存储管理）
- 基本分段存储管理（请求分段存储管理）
- 基本段页式存储管理（请求段页式存储管理）

#### 操作系统需要为内存中信息的调入和调出提供两个新的功能

1. 请求调页（请求调段）：将要访问的不在内存中的信息调入内存
2. 页面置换（段置换）：将内存中暂时用不到的信息置换到外存