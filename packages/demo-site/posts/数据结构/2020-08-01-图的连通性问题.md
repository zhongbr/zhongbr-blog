---
tags: ['数据结构','图']
---
# 图的连通性问题

## 无向图的连通分量和生成树

- 对于连通图，从一个顶点出发，进行深度或者广度优先搜索，就可以访问到所有的顶点
- 对于非连通图，需要从多个顶点出发进行搜索，每一次从一个新的起始点出发搜索到的各个顶点访问序列恰好为各个连通分量的顶点集。

深度优先得到的生成树成为深度优先生成树，广度优先得到的生成树成为广度优先生成树。

对于非连通图，每个联通分量中的顶点集和遍历所经过的边构成的生成树组成了非连通图的生成森林。

## 有向图的强连通分量

深度优先搜索是生成有向图的强连通分量的一种有效方式。

以十字链表作为有向图的存储方式：

- 从某个顶点出发沿着以该顶点为弧尾的弧，进行深度优先搜索遍历，按照其所有邻接点都完成的顺序将所有顶点排列起来。
- 从最后完成搜索的节点出发，沿着以该结点为弧头的顶点进行深度优先搜索，如果此次遍历不能访问到所有的顶点，则从余下的顶点中最后完成搜索的顶点出发，继续进行深度优先搜索，以此类推，直至图中所有的顶点都被访问一次为止。

## 最小生成树(MST)

生成树：连通图包含全部顶点的一个极小连通子图。

对于带权无向连通图，最小生成树是其所有生成树中所有边的权值最小的生成树。

### 性质

- 不一定唯一：只有当所有边的权值均不相同或者只有顶点数-1条边的时候，最小生成树一定唯一的，其他时候不一定唯一
- 权重之和唯一：最小生成树的权值之和一定是唯一的
- 最小生成树的边数等于顶点数-1

## 最小生成树的生成算法

贪心算法

```c
GENRIC_MST(G){
    T = NULL;
    while T 未生成一棵生成树{
        do 找到一条最下的代价边(u, v)并且加入T后不会产生回路;
        T = Tu(u, v);
    }
}
```

### Prim算法

- 初始化：向空的结果树 $T=(V_{T}, E_{T})$ 中添加图 $G=(V,E)$ 中的任意顶点 $v_{0}$ ，使 $V_{T}=\{u_{0}\}$ ， $E_{T}$ 为空集；
- 从G中选取符合  $\{(u,v)\lvert u \in V_{T}, v \in (V-V_{T})\}$ （此条件避免了产生回路） 且具有最小权值的边  $(u, v)$  的顶点，然后令  $V_{T}=V_{T}\cup\{v\}$ ， $E_{T}=E_{T}\cup\{(u,v)\}$ ，重复这个步骤，直到 $V_{T}=V$ 。

```c
// 记录最小的边的辅助数组
struct {
    VertexType adjvex;
    VRType lowcost;
} closedge[MAX_VERTEX_NUM];

void MinSpanTreePrim(Graph g, VertexType u){
    k = locate(g, u);
    for(j=0;j<g.vexnum;j++){
        if(j != k) closedge[j] = {u, g.arcs[k][j].adj};
    }
    closedge[k].lowcost = 0;
    for(i=1;i<g.vexnum;i++){
        k = minium(closedge);
        closedge[k].lowcost = 0;
        for(j=0;j<g.vexnum;j++){
            if(g.arcs[k][j].adj < closedge[j].lowcost){
                closedge[j] = {g.vexs[k], g.arcs[k][j].adj};
            }
        }
    }
}
```

### 关节点和重连通分量

如果删去顶点v和与顶点v相关联的各边后，将图分割为两个或多个连通分量，则称顶点v为改图的一个关节点(articulation point，也被称为割点)。

没有关节点的连通图成为重连通图(bicconected graph)。在重连通图上，任意两个节点之间都至少有两条路径，删去某个顶点及依附于某个顶点的各边后，也不破坏图的连通性。

连通度：若连通图至少需要删除k个顶点，才能破坏其连通性，则称该连通图的连通度为k。

利用深度优先搜索可以求图的关节点：

![PNG??.png](https://i.loli.net/2020/08/02/oUwPD2EAG6JRyde.png)

深度优先生成树中，实线表示树边，虚线表示回边（不再生成树上的边）。树中任意一个结点v的孩子结点为在它之后搜索的结点，双亲结点或者通过回边与之相连的祖先节点是在它之前搜索的结点。

关节点有以下两种特性：

- 若生成树的根由两棵或以上的子树，此根节点必为关节点
- 非叶子顶点v，某棵子树的根和子树的其他结点均没有指向v祖先的回边，那么此顶点v必为一个关节点

对图 $Graph=(V,\{Edge\})$ ，重新定义访问时得visited，引入一个low函数：

 $low(v)=Min\{visited[v],low[w],visited[k]\}$ 

其中：
- w是顶点v在深度优先生成树上的孩子结点
- k是顶点v在深度优先生成树上由回边连结的祖先节点
-  $(v,w) \in Edge$ 
-  $(v,k) \in Edge$ 
