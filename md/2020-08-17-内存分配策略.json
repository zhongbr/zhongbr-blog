{"ast":{"type":"Document","children":[{"type":"Yaml","value":"title: '内存分配策略'\ntags: ['操作系统','内存']","loc":{"start":{"line":1,"column":0},"end":{"line":4,"column":3}},"range":[0,43],"raw":"---\ntitle: '内存分配策略'\ntags: ['操作系统','内存']\n---"},{"type":"Header","depth":1,"children":[{"type":"Str","value":"内存分配策略","loc":{"start":{"line":5,"column":2},"end":{"line":5,"column":8}},"range":[46,52],"raw":"内存分配策略"}],"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":8}},"range":[44,52],"raw":"# 内存分配策略"},{"type":"Header","depth":2,"children":[{"type":"Str","value":"页面分配、置换策略","loc":{"start":{"line":7,"column":3},"end":{"line":7,"column":12}},"range":[57,66],"raw":"页面分配、置换策略"}],"loc":{"start":{"line":7,"column":0},"end":{"line":7,"column":12}},"range":[54,66],"raw":"## 页面分配、置换策略"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"驻留集","loc":{"start":{"line":9,"column":4},"end":{"line":9,"column":7}},"range":[72,75],"raw":"驻留集"}],"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":7}},"range":[68,75],"raw":"### 驻留集"},{"type":"Paragraph","children":[{"type":"Str","value":"请求分页存储管理中给进程分配的物理块的集合。在采用虚拟技术的系统中，驻留集的大小一般小于进程的总大小。","loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":51}},"range":[77,128],"raw":"请求分页存储管理中给进程分配的物理块的集合。在采用虚拟技术的系统中，驻留集的大小一般小于进程的总大小。"}],"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":51}},"range":[77,128],"raw":"请求分页存储管理中给进程分配的物理块的集合。在采用虚拟技术的系统中，驻留集的大小一般小于进程的总大小。"},{"type":"List","ordered":false,"start":null,"spread":false,"children":[{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"驻留集选择太小，会导致进程频繁缺页，系统需要花费大量的时间来处理缺页，实际用于推进的时间很少","loc":{"start":{"line":13,"column":2},"end":{"line":13,"column":48}},"range":[132,178],"raw":"驻留集选择太小，会导致进程频繁缺页，系统需要花费大量的时间来处理缺页，实际用于推进的时间很少"}],"loc":{"start":{"line":13,"column":2},"end":{"line":13,"column":48}},"range":[132,178],"raw":"驻留集选择太小，会导致进程频繁缺页，系统需要花费大量的时间来处理缺页，实际用于推进的时间很少"}],"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":48}},"range":[130,178],"raw":"- 驻留集选择太小，会导致进程频繁缺页，系统需要花费大量的时间来处理缺页，实际用于推进的时间很少"},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"驻留集选择太大，会导致多道程序的并发度降低，资源利用率降低","loc":{"start":{"line":14,"column":2},"end":{"line":14,"column":31}},"range":[181,210],"raw":"驻留集选择太大，会导致多道程序的并发度降低，资源利用率降低"}],"loc":{"start":{"line":14,"column":2},"end":{"line":14,"column":31}},"range":[181,210],"raw":"驻留集选择太大，会导致多道程序的并发度降低，资源利用率降低"}],"loc":{"start":{"line":14,"column":0},"end":{"line":14,"column":31}},"range":[179,210],"raw":"- 驻留集选择太大，会导致多道程序的并发度降低，资源利用率降低"}],"loc":{"start":{"line":13,"column":0},"end":{"line":14,"column":31}},"range":[130,210],"raw":"- 驻留集选择太小，会导致进程频繁缺页，系统需要花费大量的时间来处理缺页，实际用于推进的时间很少\n- 驻留集选择太大，会导致多道程序的并发度降低，资源利用率降低"},{"type":"Paragraph","children":[{"type":"Str","value":"综上所述，需要选择一个合适大小的驻留集。","loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":20}},"range":[212,232],"raw":"综上所述，需要选择一个合适大小的驻留集。"}],"loc":{"start":{"line":16,"column":0},"end":{"line":16,"column":20}},"range":[212,232],"raw":"综上所述，需要选择一个合适大小的驻留集。"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"分配策略","loc":{"start":{"line":18,"column":4},"end":{"line":18,"column":8}},"range":[238,242],"raw":"分配策略"}],"loc":{"start":{"line":18,"column":0},"end":{"line":18,"column":8}},"range":[234,242],"raw":"### 分配策略"},{"type":"List","ordered":false,"start":null,"spread":false,"children":[{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"固定分配：操作系统为每个进程分配一个固定数目的物理块，运行期间不再改变，","loc":{"start":{"line":20,"column":2},"end":{"line":20,"column":38}},"range":[246,282],"raw":"固定分配：操作系统为每个进程分配一个固定数目的物理块，运行期间不再改变，"},{"type":"Strong","children":[{"type":"Str","value":"驻留集的大小不变","loc":{"start":{"line":20,"column":40},"end":{"line":20,"column":48}},"range":[284,292],"raw":"驻留集的大小不变"}],"loc":{"start":{"line":20,"column":38},"end":{"line":20,"column":50}},"range":[282,294],"raw":"**驻留集的大小不变**"}],"loc":{"start":{"line":20,"column":2},"end":{"line":20,"column":50}},"range":[246,294],"raw":"固定分配：操作系统为每个进程分配一个固定数目的物理块，运行期间不再改变，**驻留集的大小不变**"}],"loc":{"start":{"line":20,"column":0},"end":{"line":20,"column":50}},"range":[244,294],"raw":"- 固定分配：操作系统为每个进程分配一个固定数目的物理块，运行期间不再改变，**驻留集的大小不变**"},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"可变分配：先为每个进程分配一定数目的物理块，在程序运行期间可以根据情况适当增加或者减少，","loc":{"start":{"line":21,"column":2},"end":{"line":21,"column":46}},"range":[297,341],"raw":"可变分配：先为每个进程分配一定数目的物理块，在程序运行期间可以根据情况适当增加或者减少，"},{"type":"Strong","children":[{"type":"Str","value":"驻留集的大小可变","loc":{"start":{"line":21,"column":48},"end":{"line":21,"column":56}},"range":[343,351],"raw":"驻留集的大小可变"}],"loc":{"start":{"line":21,"column":46},"end":{"line":21,"column":58}},"range":[341,353],"raw":"**驻留集的大小可变**"},{"type":"Str","value":"。","loc":{"start":{"line":21,"column":58},"end":{"line":21,"column":59}},"range":[353,354],"raw":"。"}],"loc":{"start":{"line":21,"column":2},"end":{"line":21,"column":59}},"range":[297,354],"raw":"可变分配：先为每个进程分配一定数目的物理块，在程序运行期间可以根据情况适当增加或者减少，**驻留集的大小可变**。"}],"loc":{"start":{"line":21,"column":0},"end":{"line":21,"column":59}},"range":[295,354],"raw":"- 可变分配：先为每个进程分配一定数目的物理块，在程序运行期间可以根据情况适当增加或者减少，**驻留集的大小可变**。"}],"loc":{"start":{"line":20,"column":0},"end":{"line":21,"column":59}},"range":[244,354],"raw":"- 固定分配：操作系统为每个进程分配一个固定数目的物理块，运行期间不再改变，**驻留集的大小不变**\n- 可变分配：先为每个进程分配一定数目的物理块，在程序运行期间可以根据情况适当增加或者减少，**驻留集的大小可变**。"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"置换策略","loc":{"start":{"line":23,"column":4},"end":{"line":23,"column":8}},"range":[360,364],"raw":"置换策略"}],"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":8}},"range":[356,364],"raw":"### 置换策略"},{"type":"List","ordered":false,"start":null,"spread":false,"children":[{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"局部置换：发生缺页时只能选择进程自己的物理块置换","loc":{"start":{"line":25,"column":2},"end":{"line":25,"column":26}},"range":[368,392],"raw":"局部置换：发生缺页时只能选择进程自己的物理块置换"}],"loc":{"start":{"line":25,"column":2},"end":{"line":25,"column":26}},"range":[368,392],"raw":"局部置换：发生缺页时只能选择进程自己的物理块置换"}],"loc":{"start":{"line":25,"column":0},"end":{"line":25,"column":26}},"range":[366,392],"raw":"- 局部置换：发生缺页时只能选择进程自己的物理块置换"},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"全局置换：可以将操作系统保留的空闲物理块分配给进程，也可以将别的进程持有的物理块置换到外存，再分配给缺页的进程。","loc":{"start":{"line":26,"column":2},"end":{"line":26,"column":58}},"range":[395,451],"raw":"全局置换：可以将操作系统保留的空闲物理块分配给进程，也可以将别的进程持有的物理块置换到外存，再分配给缺页的进程。"}],"loc":{"start":{"line":26,"column":2},"end":{"line":26,"column":59}},"range":[395,452],"raw":"全局置换：可以将操作系统保留的空闲物理块分配给进程，也可以将别的进程持有的物理块置换到外存，再分配给缺页的进程。 "}],"loc":{"start":{"line":26,"column":0},"end":{"line":26,"column":59}},"range":[393,452],"raw":"- 全局置换：可以将操作系统保留的空闲物理块分配给进程，也可以将别的进程持有的物理块置换到外存，再分配给缺页的进程。 "}],"loc":{"start":{"line":25,"column":0},"end":{"line":26,"column":59}},"range":[366,452],"raw":"- 局部置换：发生缺页时只能选择进程自己的物理块置换\n- 全局置换：可以将操作系统保留的空闲物理块分配给进程，也可以将别的进程持有的物理块置换到外存，再分配给缺页的进程。 "},{"type":"Table","align":[null,null,null],"children":[{"type":"TableRow","children":[{"type":"TableCell","children":[],"loc":{"start":{"line":28,"column":0},"end":{"line":28,"column":12}},"range":[454,466],"raw":"|          |"},{"type":"TableCell","children":[{"type":"Str","value":"局部置换","loc":{"start":{"line":28,"column":13},"end":{"line":28,"column":17}},"range":[467,471],"raw":"局部置换"}],"loc":{"start":{"line":28,"column":12},"end":{"line":28,"column":27}},"range":[466,481],"raw":" 局部置换         |"},{"type":"TableCell","children":[{"type":"Str","value":"全局置换","loc":{"start":{"line":28,"column":28},"end":{"line":28,"column":32}},"range":[482,486],"raw":"全局置换"}],"loc":{"start":{"line":28,"column":27},"end":{"line":28,"column":42}},"range":[481,496],"raw":" 全局置换         |"}],"loc":{"start":{"line":28,"column":0},"end":{"line":28,"column":42}},"range":[454,496],"raw":"|          | 局部置换         | 全局置换         |"},{"type":"TableRow","children":[{"type":"TableCell","children":[{"type":"Str","value":"固定分配","loc":{"start":{"line":30,"column":2},"end":{"line":30,"column":6}},"range":[550,554],"raw":"固定分配"}],"loc":{"start":{"line":30,"column":0},"end":{"line":30,"column":8}},"range":[548,556],"raw":"| 固定分配 |"},{"type":"TableCell","children":[{"type":"Str","value":"固定分配局部置换","loc":{"start":{"line":30,"column":9},"end":{"line":30,"column":17}},"range":[557,565],"raw":"固定分配局部置换"}],"loc":{"start":{"line":30,"column":8},"end":{"line":30,"column":19}},"range":[556,567],"raw":" 固定分配局部置换 |"},{"type":"TableCell","children":[{"type":"Str","value":"不存在","loc":{"start":{"line":30,"column":20},"end":{"line":30,"column":23}},"range":[568,571],"raw":"不存在"}],"loc":{"start":{"line":30,"column":19},"end":{"line":30,"column":35}},"range":[567,583],"raw":" 不存在           |"}],"loc":{"start":{"line":30,"column":0},"end":{"line":30,"column":35}},"range":[548,583],"raw":"| 固定分配 | 固定分配局部置换 | 不存在           |"},{"type":"TableRow","children":[{"type":"TableCell","children":[{"type":"Str","value":"可变分配","loc":{"start":{"line":31,"column":2},"end":{"line":31,"column":6}},"range":[586,590],"raw":"可变分配"}],"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":8}},"range":[584,592],"raw":"| 可变分配 |"},{"type":"TableCell","children":[{"type":"Str","value":"可变分配局部置换","loc":{"start":{"line":31,"column":9},"end":{"line":31,"column":17}},"range":[593,601],"raw":"可变分配局部置换"}],"loc":{"start":{"line":31,"column":8},"end":{"line":31,"column":19}},"range":[592,603],"raw":" 可变分配局部置换 |"},{"type":"TableCell","children":[{"type":"Str","value":"可变分配全局置换","loc":{"start":{"line":31,"column":20},"end":{"line":31,"column":28}},"range":[604,612],"raw":"可变分配全局置换"}],"loc":{"start":{"line":31,"column":19},"end":{"line":31,"column":30}},"range":[603,614],"raw":" 可变分配全局置换 |"}],"loc":{"start":{"line":31,"column":0},"end":{"line":31,"column":30}},"range":[584,614],"raw":"| 可变分配 | 可变分配局部置换 | 可变分配全局置换 |"}],"loc":{"start":{"line":28,"column":0},"end":{"line":31,"column":30}},"range":[454,614],"raw":"|          | 局部置换         | 全局置换         |\n| -------- | ---------------- | ---------------- |\n| 固定分配 | 固定分配局部置换 | 不存在           |\n| 可变分配 | 可变分配局部置换 | 可变分配全局置换 |"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"固定分配局部置换","loc":{"start":{"line":33,"column":4},"end":{"line":33,"column":12}},"range":[620,628],"raw":"固定分配局部置换"}],"loc":{"start":{"line":33,"column":0},"end":{"line":33,"column":12}},"range":[616,628],"raw":"### 固定分配局部置换"},{"type":"Paragraph","children":[{"type":"Str","value":"系统为进程分配一定数量的物理块，整个运行期间都不改变。若进程发生缺页，只能从该进程再内存中的页面中选出一页置换，然后调入所需要的页面。","loc":{"start":{"line":35,"column":0},"end":{"line":35,"column":67}},"range":[630,697],"raw":"系统为进程分配一定数量的物理块，整个运行期间都不改变。若进程发生缺页，只能从该进程再内存中的页面中选出一页置换，然后调入所需要的页面。"}],"loc":{"start":{"line":35,"column":0},"end":{"line":35,"column":67}},"range":[630,697],"raw":"系统为进程分配一定数量的物理块，整个运行期间都不改变。若进程发生缺页，只能从该进程再内存中的页面中选出一页置换，然后调入所需要的页面。"},{"type":"Paragraph","children":[{"type":"Str","value":"缺点：灵活性低，很难在开始时确定应该为进程分配多少个物理块才合理（只能根据进程的大小、优先级或者程序员给出的参数等来确定给进程分配的内存块数）。","loc":{"start":{"line":37,"column":0},"end":{"line":37,"column":72}},"range":[699,771],"raw":"缺点：灵活性低，很难在开始时确定应该为进程分配多少个物理块才合理（只能根据进程的大小、优先级或者程序员给出的参数等来确定给进程分配的内存块数）。"}],"loc":{"start":{"line":37,"column":0},"end":{"line":37,"column":72}},"range":[699,771],"raw":"缺点：灵活性低，很难在开始时确定应该为进程分配多少个物理块才合理（只能根据进程的大小、优先级或者程序员给出的参数等来确定给进程分配的内存块数）。"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"可变分配全局置换","loc":{"start":{"line":39,"column":4},"end":{"line":39,"column":12}},"range":[777,785],"raw":"可变分配全局置换"}],"loc":{"start":{"line":39,"column":0},"end":{"line":39,"column":12}},"range":[773,785],"raw":"### 可变分配全局置换"},{"type":"Paragraph","children":[{"type":"Str","value":"开始时，系统为进程分配一定数量的物理块。操作系统会保持一个空闲物理块队列。当某个进程发生缺页时，从空闲物理块中取出一块给该进程，若已经没有空闲物理块，选一个未锁定的页面换出外存，再将该物理块分配给缺页的进程。","loc":{"start":{"line":41,"column":0},"end":{"line":41,"column":104}},"range":[787,891],"raw":"开始时，系统为进程分配一定数量的物理块。操作系统会保持一个空闲物理块队列。当某个进程发生缺页时，从空闲物理块中取出一块给该进程，若已经没有空闲物理块，选一个未锁定的页面换出外存，再将该物理块分配给缺页的进程。"}],"loc":{"start":{"line":41,"column":0},"end":{"line":41,"column":104}},"range":[787,891],"raw":"开始时，系统为进程分配一定数量的物理块。操作系统会保持一个空闲物理块队列。当某个进程发生缺页时，从空闲物理块中取出一块给该进程，若已经没有空闲物理块，选一个未锁定的页面换出外存，再将该物理块分配给缺页的进程。"},{"type":"Paragraph","children":[{"type":"Strong","children":[{"type":"Str","value":"只要进程发生缺页，都将获得新的物理块","loc":{"start":{"line":43,"column":2},"end":{"line":43,"column":20}},"range":[895,913],"raw":"只要进程发生缺页，都将获得新的物理块"}],"loc":{"start":{"line":43,"column":0},"end":{"line":43,"column":22}},"range":[893,915],"raw":"**只要进程发生缺页，都将获得新的物理块**"},{"type":"Str","value":"，只有空闲物理块都是用完的时候才会选择未锁定的页面调出内存，被调出的页面可能是系统中任何一个进程的页，因此这个被酸中的进程拥有的物理块就会减少，缺页率会增加。","loc":{"start":{"line":43,"column":22},"end":{"line":43,"column":101}},"range":[915,994],"raw":"，只有空闲物理块都是用完的时候才会选择未锁定的页面调出内存，被调出的页面可能是系统中任何一个进程的页，因此这个被酸中的进程拥有的物理块就会减少，缺页率会增加。"}],"loc":{"start":{"line":43,"column":0},"end":{"line":43,"column":101}},"range":[893,994],"raw":"**只要进程发生缺页，都将获得新的物理块**，只有空闲物理块都是用完的时候才会选择未锁定的页面调出内存，被调出的页面可能是系统中任何一个进程的页，因此这个被酸中的进程拥有的物理块就会减少，缺页率会增加。"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"可变分配局部置换","loc":{"start":{"line":45,"column":4},"end":{"line":45,"column":12}},"range":[1000,1008],"raw":"可变分配局部置换"}],"loc":{"start":{"line":45,"column":0},"end":{"line":45,"column":12}},"range":[996,1008],"raw":"### 可变分配局部置换"},{"type":"Paragraph","children":[{"type":"Str","value":"开始时为每个进程分配一定数量的物理块，某进程发生缺页的时候，只允许从该进程自己的物理块中选出一个置换到外存，如果进程","loc":{"start":{"line":47,"column":0},"end":{"line":47,"column":58}},"range":[1010,1068],"raw":"开始时为每个进程分配一定数量的物理块，某进程发生缺页的时候，只允许从该进程自己的物理块中选出一个置换到外存，如果进程"},{"type":"Strong","children":[{"type":"Str","value":"频繁缺页，系统会为该进程多分配几个物理块","loc":{"start":{"line":47,"column":60},"end":{"line":47,"column":80}},"range":[1070,1090],"raw":"频繁缺页，系统会为该进程多分配几个物理块"}],"loc":{"start":{"line":47,"column":58},"end":{"line":47,"column":82}},"range":[1068,1092],"raw":"**频繁缺页，系统会为该进程多分配几个物理块**"},{"type":"Str","value":"，知道该进程的缺页率趋势适当程度；如果进程在运行过程中的","loc":{"start":{"line":47,"column":82},"end":{"line":47,"column":110}},"range":[1092,1120],"raw":"，知道该进程的缺页率趋势适当程度；如果进程在运行过程中的"},{"type":"Strong","children":[{"type":"Str","value":"缺页率很低，可以适当减少分配给该进程的物理块","loc":{"start":{"line":47,"column":112},"end":{"line":47,"column":134}},"range":[1122,1144],"raw":"缺页率很低，可以适当减少分配给该进程的物理块"}],"loc":{"start":{"line":47,"column":110},"end":{"line":47,"column":136}},"range":[1120,1146],"raw":"**缺页率很低，可以适当减少分配给该进程的物理块**"},{"type":"Str","value":"。","loc":{"start":{"line":47,"column":136},"end":{"line":47,"column":137}},"range":[1146,1147],"raw":"。"}],"loc":{"start":{"line":47,"column":0},"end":{"line":47,"column":137}},"range":[1010,1147],"raw":"开始时为每个进程分配一定数量的物理块，某进程发生缺页的时候，只允许从该进程自己的物理块中选出一个置换到外存，如果进程**频繁缺页，系统会为该进程多分配几个物理块**，知道该进程的缺页率趋势适当程度；如果进程在运行过程中的**缺页率很低，可以适当减少分配给该进程的物理块**。"},{"type":"Header","depth":2,"children":[{"type":"Str","value":"调入页面的时机","loc":{"start":{"line":49,"column":3},"end":{"line":49,"column":10}},"range":[1152,1159],"raw":"调入页面的时机"}],"loc":{"start":{"line":49,"column":0},"end":{"line":49,"column":10}},"range":[1149,1159],"raw":"## 调入页面的时机"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"预调页策略","loc":{"start":{"line":51,"column":4},"end":{"line":51,"column":9}},"range":[1165,1170],"raw":"预调页策略"}],"loc":{"start":{"line":51,"column":0},"end":{"line":51,"column":9}},"range":[1161,1170],"raw":"### 预调页策略"},{"type":"Paragraph","children":[{"type":"Str","value":"根据局部性原理，依次调入若干相邻的页面比一次调入一个页面更高效，但如果提前调入的页面中大多数都没有被访问过，则又是低效的。","loc":{"start":{"line":53,"column":0},"end":{"line":53,"column":61}},"range":[1172,1233],"raw":"根据局部性原理，依次调入若干相邻的页面比一次调入一个页面更高效，但如果提前调入的页面中大多数都没有被访问过，则又是低效的。"}],"loc":{"start":{"line":53,"column":0},"end":{"line":53,"column":61}},"range":[1172,1233],"raw":"根据局部性原理，依次调入若干相邻的页面比一次调入一个页面更高效，但如果提前调入的页面中大多数都没有被访问过，则又是低效的。"},{"type":"Paragraph","children":[{"type":"Str","value":"可以预测不久之后可能会被访问的页面，预先调入内存，目前这种预测的准确率只有50%左右。这种策略","loc":{"start":{"line":55,"column":0},"end":{"line":55,"column":47}},"range":[1235,1282],"raw":"可以预测不久之后可能会被访问的页面，预先调入内存，目前这种预测的准确率只有50%左右。这种策略"},{"type":"Strong","children":[{"type":"Str","value":"主要用于进程的首次调入","loc":{"start":{"line":55,"column":49},"end":{"line":55,"column":60}},"range":[1284,1295],"raw":"主要用于进程的首次调入"}],"loc":{"start":{"line":55,"column":47},"end":{"line":55,"column":62}},"range":[1282,1297],"raw":"**主要用于进程的首次调入**"},{"type":"Str","value":"，由程序员指出应该先调入哪些部分。","loc":{"start":{"line":55,"column":62},"end":{"line":55,"column":79}},"range":[1297,1314],"raw":"，由程序员指出应该先调入哪些部分。"}],"loc":{"start":{"line":55,"column":0},"end":{"line":55,"column":79}},"range":[1235,1314],"raw":"可以预测不久之后可能会被访问的页面，预先调入内存，目前这种预测的准确率只有50%左右。这种策略**主要用于进程的首次调入**，由程序员指出应该先调入哪些部分。"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"请求调页策略","loc":{"start":{"line":57,"column":4},"end":{"line":57,"column":10}},"range":[1320,1326],"raw":"请求调页策略"}],"loc":{"start":{"line":57,"column":0},"end":{"line":57,"column":10}},"range":[1316,1326],"raw":"### 请求调页策略"},{"type":"Paragraph","children":[{"type":"Str","value":"进程在运行期间发生缺页时才将页面调入内存，调入的页面一定会被访问，但是一次只能调入一页，每次调入都熬磁盘I/O操作，I/O开销较大。","loc":{"start":{"line":59,"column":0},"end":{"line":59,"column":66}},"range":[1328,1394],"raw":"进程在运行期间发生缺页时才将页面调入内存，调入的页面一定会被访问，但是一次只能调入一页，每次调入都熬磁盘I/O操作，I/O开销较大。"}],"loc":{"start":{"line":59,"column":0},"end":{"line":59,"column":66}},"range":[1328,1394],"raw":"进程在运行期间发生缺页时才将页面调入内存，调入的页面一定会被访问，但是一次只能调入一页，每次调入都熬磁盘I/O操作，I/O开销较大。"},{"type":"Header","depth":2,"children":[{"type":"Str","value":"调入页面的存放位置","loc":{"start":{"line":61,"column":3},"end":{"line":61,"column":12}},"range":[1399,1408],"raw":"调入页面的存放位置"}],"loc":{"start":{"line":61,"column":0},"end":{"line":61,"column":12}},"range":[1396,1408],"raw":"## 调入页面的存放位置"},{"type":"List","ordered":true,"start":1,"spread":false,"children":[{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"如果系统拥有足够的对换区空间，页面的调入、调出都是在内存与对换区之间进行，这样可以保证页面的调入和调出速度都很快。在进程运行之前，需要将进程相关的数据从文件去复制到对换区。","loc":{"start":{"line":63,"column":3},"end":{"line":63,"column":89}},"range":[1413,1499],"raw":"如果系统拥有足够的对换区空间，页面的调入、调出都是在内存与对换区之间进行，这样可以保证页面的调入和调出速度都很快。在进程运行之前，需要将进程相关的数据从文件去复制到对换区。"}],"loc":{"start":{"line":63,"column":3},"end":{"line":63,"column":89}},"range":[1413,1499],"raw":"如果系统拥有足够的对换区空间，页面的调入、调出都是在内存与对换区之间进行，这样可以保证页面的调入和调出速度都很快。在进程运行之前，需要将进程相关的数据从文件去复制到对换区。"}],"loc":{"start":{"line":63,"column":0},"end":{"line":63,"column":89}},"range":[1410,1499],"raw":"1. 如果系统拥有足够的对换区空间，页面的调入、调出都是在内存与对换区之间进行，这样可以保证页面的调入和调出速度都很快。在进程运行之前，需要将进程相关的数据从文件去复制到对换区。"},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"如果系统对换区不够：","loc":{"start":{"line":64,"column":3},"end":{"line":64,"column":13}},"range":[1503,1513],"raw":"如果系统对换区不够："}],"loc":{"start":{"line":64,"column":3},"end":{"line":64,"column":13}},"range":[1503,1513],"raw":"如果系统对换区不够："},{"type":"List","ordered":false,"start":null,"spread":false,"children":[{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"凡是不会被修改的数据都直接从文件区调入内存，由于这些页面不会被修改，因此换出时不必写回磁盘，下次需要时再从文件区调入即可。","loc":{"start":{"line":65,"column":5},"end":{"line":65,"column":66}},"range":[1519,1580],"raw":"凡是不会被修改的数据都直接从文件区调入内存，由于这些页面不会被修改，因此换出时不必写回磁盘，下次需要时再从文件区调入即可。"}],"loc":{"start":{"line":65,"column":5},"end":{"line":65,"column":66}},"range":[1519,1580],"raw":"凡是不会被修改的数据都直接从文件区调入内存，由于这些页面不会被修改，因此换出时不必写回磁盘，下次需要时再从文件区调入即可。"}],"loc":{"start":{"line":65,"column":3},"end":{"line":65,"column":66}},"range":[1517,1580],"raw":"- 凡是不会被修改的数据都直接从文件区调入内存，由于这些页面不会被修改，因此换出时不必写回磁盘，下次需要时再从文件区调入即可。"},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"对于可能会被修改的数据，换出时需要写入磁盘的对换区，下次需要时从对换区调入","loc":{"start":{"line":66,"column":5},"end":{"line":66,"column":42}},"range":[1586,1623],"raw":"对于可能会被修改的数据，换出时需要写入磁盘的对换区，下次需要时从对换区调入"}],"loc":{"start":{"line":66,"column":5},"end":{"line":66,"column":42}},"range":[1586,1623],"raw":"对于可能会被修改的数据，换出时需要写入磁盘的对换区，下次需要时从对换区调入"}],"loc":{"start":{"line":66,"column":3},"end":{"line":66,"column":42}},"range":[1584,1623],"raw":"- 对于可能会被修改的数据，换出时需要写入磁盘的对换区，下次需要时从对换区调入"}],"loc":{"start":{"line":65,"column":3},"end":{"line":66,"column":42}},"range":[1517,1623],"raw":"- 凡是不会被修改的数据都直接从文件区调入内存，由于这些页面不会被修改，因此换出时不必写回磁盘，下次需要时再从文件区调入即可。\n   - 对于可能会被修改的数据，换出时需要写入磁盘的对换区，下次需要时从对换区调入"}],"loc":{"start":{"line":64,"column":0},"end":{"line":66,"column":42}},"range":[1500,1623],"raw":"2. 如果系统对换区不够：\n   - 凡是不会被修改的数据都直接从文件区调入内存，由于这些页面不会被修改，因此换出时不必写回磁盘，下次需要时再从文件区调入即可。\n   - 对于可能会被修改的数据，换出时需要写入磁盘的对换区，下次需要时从对换区调入"},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"UNIX方式：运行之前进程有关的数据全部放在文件区，未使用过的页面，都可以从文件区调入，若被使用过的页面需要换出，则写回对换区，下次需要时再从对换区调入。","loc":{"start":{"line":67,"column":3},"end":{"line":67,"column":80}},"range":[1627,1704],"raw":"UNIX方式：运行之前进程有关的数据全部放在文件区，未使用过的页面，都可以从文件区调入，若被使用过的页面需要换出，则写回对换区，下次需要时再从对换区调入。"}],"loc":{"start":{"line":67,"column":3},"end":{"line":67,"column":80}},"range":[1627,1704],"raw":"UNIX方式：运行之前进程有关的数据全部放在文件区，未使用过的页面，都可以从文件区调入，若被使用过的页面需要换出，则写回对换区，下次需要时再从对换区调入。"}],"loc":{"start":{"line":67,"column":0},"end":{"line":67,"column":80}},"range":[1624,1704],"raw":"3. UNIX方式：运行之前进程有关的数据全部放在文件区，未使用过的页面，都可以从文件区调入，若被使用过的页面需要换出，则写回对换区，下次需要时再从对换区调入。"}],"loc":{"start":{"line":63,"column":0},"end":{"line":67,"column":80}},"range":[1410,1704],"raw":"1. 如果系统拥有足够的对换区空间，页面的调入、调出都是在内存与对换区之间进行，这样可以保证页面的调入和调出速度都很快。在进程运行之前，需要将进程相关的数据从文件去复制到对换区。\n2. 如果系统对换区不够：\n   - 凡是不会被修改的数据都直接从文件区调入内存，由于这些页面不会被修改，因此换出时不必写回磁盘，下次需要时再从文件区调入即可。\n   - 对于可能会被修改的数据，换出时需要写入磁盘的对换区，下次需要时从对换区调入\n3. UNIX方式：运行之前进程有关的数据全部放在文件区，未使用过的页面，都可以从文件区调入，若被使用过的页面需要换出，则写回对换区，下次需要时再从对换区调入。"},{"type":"Header","depth":2,"children":[{"type":"Str","value":"抖动（颠簸）现象","loc":{"start":{"line":69,"column":3},"end":{"line":69,"column":11}},"range":[1709,1717],"raw":"抖动（颠簸）现象"}],"loc":{"start":{"line":69,"column":0},"end":{"line":69,"column":11}},"range":[1706,1717],"raw":"## 抖动（颠簸）现象"},{"type":"Paragraph","children":[{"type":"Str","value":"刚刚换出的页面马上又要换入内存，刚刚换入的页面马上又要被换出到外存，这种频繁的页面调度行为称为抖动，或者颠簸。","loc":{"start":{"line":71,"column":0},"end":{"line":71,"column":55}},"range":[1719,1774],"raw":"刚刚换出的页面马上又要换入内存，刚刚换入的页面马上又要被换出到外存，这种频繁的页面调度行为称为抖动，或者颠簸。"}],"loc":{"start":{"line":71,"column":0},"end":{"line":71,"column":55}},"range":[1719,1774],"raw":"刚刚换出的页面马上又要换入内存，刚刚换入的页面马上又要被换出到外存，这种频繁的页面调度行为称为抖动，或者颠簸。"},{"type":"Paragraph","children":[{"type":"Str","value":"主要原因：进程频繁访问的页面数目高于可用的物理块数（分配给进程的物理块不够）","loc":{"start":{"line":73,"column":0},"end":{"line":73,"column":38}},"range":[1776,1814],"raw":"主要原因：进程频繁访问的页面数目高于可用的物理块数（分配给进程的物理块不够）"}],"loc":{"start":{"line":73,"column":0},"end":{"line":73,"column":38}},"range":[1776,1814],"raw":"主要原因：进程频繁访问的页面数目高于可用的物理块数（分配给进程的物理块不够）"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"工作集","loc":{"start":{"line":75,"column":4},"end":{"line":75,"column":7}},"range":[1820,1823],"raw":"工作集"}],"loc":{"start":{"line":75,"column":0},"end":{"line":75,"column":7}},"range":[1816,1823],"raw":"### 工作集"},{"type":"Paragraph","children":[{"type":"Str","value":"在某段时间间隔内，进程实际访问的页面集合","loc":{"start":{"line":77,"column":0},"end":{"line":77,"column":20}},"range":[1825,1845],"raw":"在某段时间间隔内，进程实际访问的页面集合"}],"loc":{"start":{"line":77,"column":0},"end":{"line":77,"column":20}},"range":[1825,1845],"raw":"在某段时间间隔内，进程实际访问的页面集合"},{"type":"Paragraph","children":[{"type":"Str","value":"工作集的大小可能小于窗口的尺寸，操作系统可以统计进程工作集的带线啊哦，根据工作集大小给进程分配若干内存块。","loc":{"start":{"line":79,"column":0},"end":{"line":79,"column":53}},"range":[1847,1900],"raw":"工作集的大小可能小于窗口的尺寸，操作系统可以统计进程工作集的带线啊哦，根据工作集大小给进程分配若干内存块。"}],"loc":{"start":{"line":79,"column":0},"end":{"line":79,"column":53}},"range":[1847,1900],"raw":"工作集的大小可能小于窗口的尺寸，操作系统可以统计进程工作集的带线啊哦，根据工作集大小给进程分配若干内存块。"},{"type":"Paragraph","children":[{"type":"Str","value":"驻留集的大小不能小于工作集的大小，否则会频繁发生缺页。","loc":{"start":{"line":81,"column":0},"end":{"line":81,"column":27}},"range":[1902,1929],"raw":"驻留集的大小不能小于工作集的大小，否则会频繁发生缺页。"}],"loc":{"start":{"line":81,"column":0},"end":{"line":81,"column":27}},"range":[1902,1929],"raw":"驻留集的大小不能小于工作集的大小，否则会频繁发生缺页。"}],"loc":{"start":{"line":1,"column":0},"end":{"line":81,"column":27}},"range":[0,1929],"raw":"---\ntitle: '内存分配策略'\ntags: ['操作系统','内存']\n---\n# 内存分配策略\n\n## 页面分配、置换策略\n\n### 驻留集\n\n请求分页存储管理中给进程分配的物理块的集合。在采用虚拟技术的系统中，驻留集的大小一般小于进程的总大小。\n\n- 驻留集选择太小，会导致进程频繁缺页，系统需要花费大量的时间来处理缺页，实际用于推进的时间很少\n- 驻留集选择太大，会导致多道程序的并发度降低，资源利用率降低\n\n综上所述，需要选择一个合适大小的驻留集。\n\n### 分配策略\n\n- 固定分配：操作系统为每个进程分配一个固定数目的物理块，运行期间不再改变，**驻留集的大小不变**\n- 可变分配：先为每个进程分配一定数目的物理块，在程序运行期间可以根据情况适当增加或者减少，**驻留集的大小可变**。\n\n### 置换策略\n\n- 局部置换：发生缺页时只能选择进程自己的物理块置换\n- 全局置换：可以将操作系统保留的空闲物理块分配给进程，也可以将别的进程持有的物理块置换到外存，再分配给缺页的进程。 \n\n|          | 局部置换         | 全局置换         |\n| -------- | ---------------- | ---------------- |\n| 固定分配 | 固定分配局部置换 | 不存在           |\n| 可变分配 | 可变分配局部置换 | 可变分配全局置换 |\n\n### 固定分配局部置换\n\n系统为进程分配一定数量的物理块，整个运行期间都不改变。若进程发生缺页，只能从该进程再内存中的页面中选出一页置换，然后调入所需要的页面。\n\n缺点：灵活性低，很难在开始时确定应该为进程分配多少个物理块才合理（只能根据进程的大小、优先级或者程序员给出的参数等来确定给进程分配的内存块数）。\n\n### 可变分配全局置换\n\n开始时，系统为进程分配一定数量的物理块。操作系统会保持一个空闲物理块队列。当某个进程发生缺页时，从空闲物理块中取出一块给该进程，若已经没有空闲物理块，选一个未锁定的页面换出外存，再将该物理块分配给缺页的进程。\n\n**只要进程发生缺页，都将获得新的物理块**，只有空闲物理块都是用完的时候才会选择未锁定的页面调出内存，被调出的页面可能是系统中任何一个进程的页，因此这个被酸中的进程拥有的物理块就会减少，缺页率会增加。\n\n### 可变分配局部置换\n\n开始时为每个进程分配一定数量的物理块，某进程发生缺页的时候，只允许从该进程自己的物理块中选出一个置换到外存，如果进程**频繁缺页，系统会为该进程多分配几个物理块**，知道该进程的缺页率趋势适当程度；如果进程在运行过程中的**缺页率很低，可以适当减少分配给该进程的物理块**。\n\n## 调入页面的时机\n\n### 预调页策略\n\n根据局部性原理，依次调入若干相邻的页面比一次调入一个页面更高效，但如果提前调入的页面中大多数都没有被访问过，则又是低效的。\n\n可以预测不久之后可能会被访问的页面，预先调入内存，目前这种预测的准确率只有50%左右。这种策略**主要用于进程的首次调入**，由程序员指出应该先调入哪些部分。\n\n### 请求调页策略\n\n进程在运行期间发生缺页时才将页面调入内存，调入的页面一定会被访问，但是一次只能调入一页，每次调入都熬磁盘I/O操作，I/O开销较大。\n\n## 调入页面的存放位置\n\n1. 如果系统拥有足够的对换区空间，页面的调入、调出都是在内存与对换区之间进行，这样可以保证页面的调入和调出速度都很快。在进程运行之前，需要将进程相关的数据从文件去复制到对换区。\n2. 如果系统对换区不够：\n   - 凡是不会被修改的数据都直接从文件区调入内存，由于这些页面不会被修改，因此换出时不必写回磁盘，下次需要时再从文件区调入即可。\n   - 对于可能会被修改的数据，换出时需要写入磁盘的对换区，下次需要时从对换区调入\n3. UNIX方式：运行之前进程有关的数据全部放在文件区，未使用过的页面，都可以从文件区调入，若被使用过的页面需要换出，则写回对换区，下次需要时再从对换区调入。\n\n## 抖动（颠簸）现象\n\n刚刚换出的页面马上又要换入内存，刚刚换入的页面马上又要被换出到外存，这种频繁的页面调度行为称为抖动，或者颠簸。\n\n主要原因：进程频繁访问的页面数目高于可用的物理块数（分配给进程的物理块不够）\n\n### 工作集\n\n在某段时间间隔内，进程实际访问的页面集合\n\n工作集的大小可能小于窗口的尺寸，操作系统可以统计进程工作集的带线啊哦，根据工作集大小给进程分配若干内存块。\n\n驻留集的大小不能小于工作集的大小，否则会频繁发生缺页。"},"catalogue":{"title":"内存分配策略","json-path":"2020-08-17-内存分配策略.json","mdate":"2022-08-30T14:19:31.454Z","tags":["操作系统","内存"]}}