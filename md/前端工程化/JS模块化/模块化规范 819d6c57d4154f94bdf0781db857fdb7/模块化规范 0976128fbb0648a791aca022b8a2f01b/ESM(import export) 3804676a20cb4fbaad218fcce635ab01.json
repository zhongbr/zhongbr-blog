{"ast":{"type":"Document","children":[{"type":"Header","depth":1,"children":[{"type":"Str","value":"ESM(import/export)","loc":{"start":{"line":1,"column":2},"end":{"line":1,"column":20}},"range":[2,20],"raw":"ESM(import/export)"}],"loc":{"start":{"line":1,"column":0},"end":{"line":1,"column":20}},"range":[0,20],"raw":"# ESM(import/export)"},{"type":"Paragraph","children":[{"type":"Str","value":"Tags: exports, import","loc":{"start":{"line":3,"column":0},"end":{"line":3,"column":21}},"range":[22,43],"raw":"Tags: exports, import"}],"loc":{"start":{"line":3,"column":0},"end":{"line":3,"column":21}},"range":[22,43],"raw":"Tags: exports, import"},{"type":"Header","depth":2,"children":[{"type":"Str","value":"æ¦‚è¿°","loc":{"start":{"line":5,"column":3},"end":{"line":5,"column":5}},"range":[48,50],"raw":"æ¦‚è¿°"}],"loc":{"start":{"line":5,"column":0},"end":{"line":5,"column":5}},"range":[45,50],"raw":"## æ¦‚è¿°"},{"type":"Paragraph","children":[{"type":"Str","value":"åœ¨ ES6 ä¸­ï¼Œå¼•å…¥äº†ä¸€å¥—æ–°çš„æ¨¡å—åŒ–è§„èŒƒï¼Œä»è¯­è¨€å±‚é¢å®ç°äº†æ¨¡å—åŠŸèƒ½ï¼Œé‚£å°±æ˜¯ ESMã€‚","loc":{"start":{"line":7,"column":0},"end":{"line":7,"column":42}},"range":[52,94],"raw":"åœ¨ ES6 ä¸­ï¼Œå¼•å…¥äº†ä¸€å¥—æ–°çš„æ¨¡å—åŒ–è§„èŒƒï¼Œä»è¯­è¨€å±‚é¢å®ç°äº†æ¨¡å—åŠŸèƒ½ï¼Œé‚£å°±æ˜¯ ESMã€‚"}],"loc":{"start":{"line":7,"column":0},"end":{"line":7,"column":42}},"range":[52,94],"raw":"åœ¨ ES6 ä¸­ï¼Œå¼•å…¥äº†ä¸€å¥—æ–°çš„æ¨¡å—åŒ–è§„èŒƒï¼Œä»è¯­è¨€å±‚é¢å®ç°äº†æ¨¡å—åŠŸèƒ½ï¼Œé‚£å°±æ˜¯ ESMã€‚"},{"type":"Paragraph","children":[{"type":"Str","value":"ESM æ¨¡å—çš„ import è¯­å¥ï¼Œ","loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":18}},"range":[96,114],"raw":"ESM æ¨¡å—çš„ import è¯­å¥ï¼Œ"},{"type":"Strong","children":[{"type":"Str","value":"æ˜¯é™æ€è§£æçš„ï¼Œåœ¨ç¼–è¯‘æ—¶ï¼Œå°±ä¼šè§£æå¹¶åŠ è½½å¯¹åº”çš„æ¨¡å—","loc":{"start":{"line":9,"column":20},"end":{"line":9,"column":44}},"range":[116,140],"raw":"æ˜¯é™æ€è§£æçš„ï¼Œåœ¨ç¼–è¯‘æ—¶ï¼Œå°±ä¼šè§£æå¹¶åŠ è½½å¯¹åº”çš„æ¨¡å—"}],"loc":{"start":{"line":9,"column":18},"end":{"line":9,"column":46}},"range":[114,142],"raw":"**æ˜¯é™æ€è§£æçš„ï¼Œåœ¨ç¼–è¯‘æ—¶ï¼Œå°±ä¼šè§£æå¹¶åŠ è½½å¯¹åº”çš„æ¨¡å—**"},{"type":"Str","value":"ã€‚æ‰€ä»¥ä½¿ç”¨ ESM æ—¶ï¼Œimport è¯­å¥éœ€è¦åœ¨æ–‡ä»¶çš„é¡¶å±‚ã€‚","loc":{"start":{"line":9,"column":46},"end":{"line":9,"column":76}},"range":[142,172],"raw":"ã€‚æ‰€ä»¥ä½¿ç”¨ ESM æ—¶ï¼Œimport è¯­å¥éœ€è¦åœ¨æ–‡ä»¶çš„é¡¶å±‚ã€‚"}],"loc":{"start":{"line":9,"column":0},"end":{"line":9,"column":76}},"range":[96,172],"raw":"ESM æ¨¡å—çš„ import è¯­å¥ï¼Œ**æ˜¯é™æ€è§£æçš„ï¼Œåœ¨ç¼–è¯‘æ—¶ï¼Œå°±ä¼šè§£æå¹¶åŠ è½½å¯¹åº”çš„æ¨¡å—**ã€‚æ‰€ä»¥ä½¿ç”¨ ESM æ—¶ï¼Œimport è¯­å¥éœ€è¦åœ¨æ–‡ä»¶çš„é¡¶å±‚ã€‚"},{"type":"Header","depth":2,"children":[{"type":"Str","value":"åŠ è½½è¿‡ç¨‹","loc":{"start":{"line":11,"column":3},"end":{"line":11,"column":7}},"range":[177,181],"raw":"åŠ è½½è¿‡ç¨‹"}],"loc":{"start":{"line":11,"column":0},"end":{"line":11,"column":7}},"range":[174,181],"raw":"## åŠ è½½è¿‡ç¨‹"},{"type":"Paragraph","children":[{"type":"Str","value":"åœ¨ ESM ä¸­ï¼Œæ¨¡å—çš„åŠ è½½æ˜¯","loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":14}},"range":[183,197],"raw":"åœ¨ ESM ä¸­ï¼Œæ¨¡å—çš„åŠ è½½æ˜¯"},{"type":"Strong","children":[{"type":"Str","value":"å¼‚æ­¥æ‰§è¡Œ","loc":{"start":{"line":13,"column":16},"end":{"line":13,"column":20}},"range":[199,203],"raw":"å¼‚æ­¥æ‰§è¡Œ"}],"loc":{"start":{"line":13,"column":14},"end":{"line":13,"column":22}},"range":[197,205],"raw":"**å¼‚æ­¥æ‰§è¡Œ**"},{"type":"Str","value":"çš„ã€‚åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œæ‰€æœ‰ä½¿ç”¨åˆ° import å’Œ export å…³é”®å­—çš„è¯­å¥éƒ½ä¼šè¢«è§£æï¼Œç”¨æ¥æ„å»º","loc":{"start":{"line":13,"column":22},"end":{"line":13,"column":68}},"range":[205,251],"raw":"çš„ã€‚åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œæ‰€æœ‰ä½¿ç”¨åˆ° import å’Œ export å…³é”®å­—çš„è¯­å¥éƒ½ä¼šè¢«è§£æï¼Œç”¨æ¥æ„å»º"},{"type":"Strong","children":[{"type":"Str","value":"ä¾èµ–å…³ç³»å›¾","loc":{"start":{"line":13,"column":70},"end":{"line":13,"column":75}},"range":[253,258],"raw":"ä¾èµ–å…³ç³»å›¾"}],"loc":{"start":{"line":13,"column":68},"end":{"line":13,"column":77}},"range":[251,260],"raw":"**ä¾èµ–å…³ç³»å›¾**"},{"type":"Str","value":"ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œè¢«å¼•å…¥çš„è„šæœ¬å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œã€‚","loc":{"start":{"line":13,"column":77},"end":{"line":13,"column":98}},"range":[260,281],"raw":"ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œè¢«å¼•å…¥çš„è„šæœ¬å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œã€‚"}],"loc":{"start":{"line":13,"column":0},"end":{"line":13,"column":98}},"range":[183,281],"raw":"åœ¨ ESM ä¸­ï¼Œæ¨¡å—çš„åŠ è½½æ˜¯**å¼‚æ­¥æ‰§è¡Œ**çš„ã€‚åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œæ‰€æœ‰ä½¿ç”¨åˆ° import å’Œ export å…³é”®å­—çš„è¯­å¥éƒ½ä¼šè¢«è§£æï¼Œç”¨æ¥æ„å»º**ä¾èµ–å…³ç³»å›¾**ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œè¢«å¼•å…¥çš„è„šæœ¬å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œã€‚"},{"type":"Paragraph","children":[{"type":"Str","value":"ESM æ¨¡å—åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œä¸éœ€è¦å®é™…æ‰§è¡Œè¢«å¼•å…¥çš„æ–‡ä»¶çš„ä»£ç ï¼Œä¸€äº› named import å†…çš„é”™è¯¯å°±å¯ä»¥è¢«å‘ç°ã€‚","loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":58}},"range":[283,341],"raw":"ESM æ¨¡å—åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œä¸éœ€è¦å®é™…æ‰§è¡Œè¢«å¼•å…¥çš„æ–‡ä»¶çš„ä»£ç ï¼Œä¸€äº› named import å†…çš„é”™è¯¯å°±å¯ä»¥è¢«å‘ç°ã€‚"}],"loc":{"start":{"line":15,"column":0},"end":{"line":15,"column":58}},"range":[283,341],"raw":"ESM æ¨¡å—åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œä¸éœ€è¦å®é™…æ‰§è¡Œè¢«å¼•å…¥çš„æ–‡ä»¶çš„ä»£ç ï¼Œä¸€äº› named import å†…çš„é”™è¯¯å°±å¯ä»¥è¢«å‘ç°ã€‚"},{"type":"Paragraph","children":[{"type":"Str","value":"ESM æ¨¡å—åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæ ¹æ® import å…³é”®å­—è¯­å¥ï¼Œç”±å¤–åˆ°å†…æ„å»ºæ¨¡å—ä¹‹é—´çš„**ä¾èµ–å…³ç³»å›¾ï¼Œ**ç›´åˆ°æ²¡æœ‰ä»»ä½•å…¶ä»–ä¾èµ–çš„æ¨¡å—ã€‚ç„¶åç”±å†…å‘å¤–æ‰§è¡Œï¼Œä¸€ä¸ªæ¨¡å—ä¾èµ–çš„å…¶ä»–æ¨¡å—éƒ½æ‰§è¡Œå®Œæˆä»¥åï¼Œè¿™ä¸ªæ¨¡å—æ‰èƒ½å¾—åˆ°æ‰§è¡Œã€‚","loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":113}},"range":[343,456],"raw":"ESM æ¨¡å—åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæ ¹æ® import å…³é”®å­—è¯­å¥ï¼Œç”±å¤–åˆ°å†…æ„å»ºæ¨¡å—ä¹‹é—´çš„**ä¾èµ–å…³ç³»å›¾ï¼Œ**ç›´åˆ°æ²¡æœ‰ä»»ä½•å…¶ä»–ä¾èµ–çš„æ¨¡å—ã€‚ç„¶åç”±å†…å‘å¤–æ‰§è¡Œï¼Œä¸€ä¸ªæ¨¡å—ä¾èµ–çš„å…¶ä»–æ¨¡å—éƒ½æ‰§è¡Œå®Œæˆä»¥åï¼Œè¿™ä¸ªæ¨¡å—æ‰èƒ½å¾—åˆ°æ‰§è¡Œã€‚"}],"loc":{"start":{"line":17,"column":0},"end":{"line":17,"column":113}},"range":[343,456],"raw":"ESM æ¨¡å—åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæ ¹æ® import å…³é”®å­—è¯­å¥ï¼Œç”±å¤–åˆ°å†…æ„å»ºæ¨¡å—ä¹‹é—´çš„**ä¾èµ–å…³ç³»å›¾ï¼Œ**ç›´åˆ°æ²¡æœ‰ä»»ä½•å…¶ä»–ä¾èµ–çš„æ¨¡å—ã€‚ç„¶åç”±å†…å‘å¤–æ‰§è¡Œï¼Œä¸€ä¸ªæ¨¡å—ä¾èµ–çš„å…¶ä»–æ¨¡å—éƒ½æ‰§è¡Œå®Œæˆä»¥åï¼Œè¿™ä¸ªæ¨¡å—æ‰èƒ½å¾—åˆ°æ‰§è¡Œã€‚"},{"type":"Header","depth":2,"children":[{"type":"Str","value":"ç‰¹ç‚¹","loc":{"start":{"line":19,"column":3},"end":{"line":19,"column":5}},"range":[461,463],"raw":"ç‰¹ç‚¹"}],"loc":{"start":{"line":19,"column":0},"end":{"line":19,"column":5}},"range":[458,463],"raw":"## ç‰¹ç‚¹"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"1. ESM å¯¼å…¥å’Œå¯¼å‡ºæ˜¯å¼•ç”¨ä¼ é€’","loc":{"start":{"line":21,"column":4},"end":{"line":21,"column":21}},"range":[469,486],"raw":"1. ESM å¯¼å…¥å’Œå¯¼å‡ºæ˜¯å¼•ç”¨ä¼ é€’"}],"loc":{"start":{"line":21,"column":0},"end":{"line":21,"column":21}},"range":[465,486],"raw":"### 1. ESM å¯¼å…¥å’Œå¯¼å‡ºæ˜¯å¼•ç”¨ä¼ é€’"},{"type":"Paragraph","children":[{"type":"Str","value":"é€šè¿‡ export å¯¼å‡ºå€¼ï¼Œé€šè¿‡ import å¯¼å…¥ï¼Œ**è¿™ä¸¤ä¸ªæ˜¯å…³é”®å­—ï¼Œ**ä¸”ä½¿ç”¨ export å¯¼å‡ºçš„å€¼æ˜¯å¼•ç”¨ä¼ é€’ï¼ˆä¸¤ä¸ªæ ‡è¯†ç¬¦æŒ‡å‘çš„æ˜¯åŒä¸€å—å†…å­˜ï¼‰","loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":75}},"range":[488,563],"raw":"é€šè¿‡ export å¯¼å‡ºå€¼ï¼Œé€šè¿‡ import å¯¼å…¥ï¼Œ**è¿™ä¸¤ä¸ªæ˜¯å…³é”®å­—ï¼Œ**ä¸”ä½¿ç”¨ export å¯¼å‡ºçš„å€¼æ˜¯å¼•ç”¨ä¼ é€’ï¼ˆä¸¤ä¸ªæ ‡è¯†ç¬¦æŒ‡å‘çš„æ˜¯åŒä¸€å—å†…å­˜ï¼‰"}],"loc":{"start":{"line":23,"column":0},"end":{"line":23,"column":75}},"range":[488,563],"raw":"é€šè¿‡ export å¯¼å‡ºå€¼ï¼Œé€šè¿‡ import å¯¼å…¥ï¼Œ**è¿™ä¸¤ä¸ªæ˜¯å…³é”®å­—ï¼Œ**ä¸”ä½¿ç”¨ export å¯¼å‡ºçš„å€¼æ˜¯å¼•ç”¨ä¼ é€’ï¼ˆä¸¤ä¸ªæ ‡è¯†ç¬¦æŒ‡å‘çš„æ˜¯åŒä¸€å—å†…å­˜ï¼‰"},{"type":"CodeBlock","lang":"jsx","meta":null,"value":"// a.js\nexport let a = 1;\nexport function changeA(v) {\n\ta = v;\n}\n\n// b.js\nimport { a, changeA } from 'a';\nconsole.log(a);\nchangeA(2);\nconsole.log(a);\n\n// è¾“å‡º\n// 1\n// 2","loc":{"start":{"line":25,"column":0},"end":{"line":41,"column":3}},"range":[565,742],"raw":"```jsx\n// a.js\nexport let a = 1;\nexport function changeA(v) {\n\ta = v;\n}\n\n// b.js\nimport { a, changeA } from 'a';\nconsole.log(a);\nchangeA(2);\nconsole.log(a);\n\n// è¾“å‡º\n// 1\n// 2\n```"},{"type":"Header","depth":3,"children":[{"type":"Str","value":"2. ESM æ¨¡å—å†…æ”¯æŒ Top Level Await","loc":{"start":{"line":43,"column":4},"end":{"line":43,"column":32}},"range":[748,776],"raw":"2. ESM æ¨¡å—å†…æ”¯æŒ Top Level Await"}],"loc":{"start":{"line":43,"column":0},"end":{"line":43,"column":32}},"range":[744,776],"raw":"### 2. ESM æ¨¡å—å†…æ”¯æŒ Top Level Await"},{"type":"Paragraph","children":[{"type":"Str","value":"å¾—ç›Šäº esm æ¨¡å—çš„åŠ è½½æœºåˆ¶ï¼Œæ¨¡å—çš„æ‰§è¡Œå‘ç”Ÿåœ¨ä¾èµ–å…³ç³»å›¾æ„å»ºå®Œæˆä»¥åï¼Œåœ¨ esm æ¨¡å—å†…ï¼Œå¯ä»¥åœ¨æ¨¡å—çš„é¡¶å±‚ä½¿ç”¨ await å…³é”®å­—ã€‚","loc":{"start":{"line":45,"column":0},"end":{"line":45,"column":67}},"range":[778,845],"raw":"å¾—ç›Šäº esm æ¨¡å—çš„åŠ è½½æœºåˆ¶ï¼Œæ¨¡å—çš„æ‰§è¡Œå‘ç”Ÿåœ¨ä¾èµ–å…³ç³»å›¾æ„å»ºå®Œæˆä»¥åï¼Œåœ¨ esm æ¨¡å—å†…ï¼Œå¯ä»¥åœ¨æ¨¡å—çš„é¡¶å±‚ä½¿ç”¨ await å…³é”®å­—ã€‚"}],"loc":{"start":{"line":45,"column":0},"end":{"line":45,"column":67}},"range":[778,845],"raw":"å¾—ç›Šäº esm æ¨¡å—çš„åŠ è½½æœºåˆ¶ï¼Œæ¨¡å—çš„æ‰§è¡Œå‘ç”Ÿåœ¨ä¾èµ–å…³ç³»å›¾æ„å»ºå®Œæˆä»¥åï¼Œåœ¨ esm æ¨¡å—å†…ï¼Œå¯ä»¥åœ¨æ¨¡å—çš„é¡¶å±‚ä½¿ç”¨ await å…³é”®å­—ã€‚"},{"type":"Paragraph","children":[{"type":"Str","value":"ä¸‹é¢æ˜¯ä¸€æ®µå¼•ç”¨è‡ª v8 åšå®¢(","loc":{"start":{"line":47,"column":0},"end":{"line":47,"column":15}},"range":[847,862],"raw":"ä¸‹é¢æ˜¯ä¸€æ®µå¼•ç”¨è‡ª v8 åšå®¢("},{"type":"Link","title":null,"url":"https://v8.dev/features/top-level-await","children":[{"type":"Str","value":"Top-level await","loc":{"start":{"line":47,"column":16},"end":{"line":47,"column":31}},"range":[863,878],"raw":"Top-level await"}],"loc":{"start":{"line":47,"column":15},"end":{"line":47,"column":73}},"range":[862,920],"raw":"[Top-level await](https://v8.dev/features/top-level-await)"},{"type":"Str","value":")çš„ä¸€æ®µï¼š","loc":{"start":{"line":47,"column":73},"end":{"line":47,"column":78}},"range":[920,925],"raw":")çš„ä¸€æ®µï¼š"}],"loc":{"start":{"line":47,"column":0},"end":{"line":47,"column":78}},"range":[847,925],"raw":"ä¸‹é¢æ˜¯ä¸€æ®µå¼•ç”¨è‡ª v8 åšå®¢([Top-level await](https://v8.dev/features/top-level-await))çš„ä¸€æ®µï¼š"},{"type":"BlockQuote","children":[{"type":"Paragraph","children":[{"type":"Str","value":"Perhaps you have seen the infamous gist by Rich Harris which initially outlined a number of concerns about top-level await and urged the JavaScript language not to implement the feature. Some specific concerns were:","loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":217}},"range":[929,1144],"raw":"Perhaps you have seen the infamous gist by Rich Harris which initially outlined a number of concerns about top-level await and urged the JavaScript language not to implement the feature. Some specific concerns were:"}],"loc":{"start":{"line":49,"column":2},"end":{"line":49,"column":217}},"range":[929,1144],"raw":"Perhaps you have seen the infamous gist by Rich Harris which initially outlined a number of concerns about top-level await and urged the JavaScript language not to implement the feature. Some specific concerns were:"},{"type":"List","ordered":false,"start":null,"spread":false,"children":[{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"Top-level await could block execution.","loc":{"start":{"line":51,"column":4},"end":{"line":51,"column":42}},"range":[1152,1190],"raw":"Top-level await could block execution."}],"loc":{"start":{"line":51,"column":4},"end":{"line":51,"column":42}},"range":[1152,1190],"raw":"Top-level await could block execution."}],"loc":{"start":{"line":51,"column":2},"end":{"line":51,"column":42}},"range":[1150,1190],"raw":"- Top-level await could block execution."},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"Top-level await could block fetching resources.","loc":{"start":{"line":52,"column":4},"end":{"line":52,"column":51}},"range":[1195,1242],"raw":"Top-level await could block fetching resources."}],"loc":{"start":{"line":52,"column":4},"end":{"line":52,"column":51}},"range":[1195,1242],"raw":"Top-level await could block fetching resources."}],"loc":{"start":{"line":52,"column":2},"end":{"line":52,"column":51}},"range":[1193,1242],"raw":"- Top-level await could block fetching resources."},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Str","value":"There would be no clear interop story for CommonJS modules.","loc":{"start":{"line":53,"column":4},"end":{"line":53,"column":63}},"range":[1247,1306],"raw":"There would be no clear interop story for CommonJS modules."}],"loc":{"start":{"line":53,"column":4},"end":{"line":53,"column":63}},"range":[1247,1306],"raw":"There would be no clear interop story for CommonJS modules."}],"loc":{"start":{"line":53,"column":2},"end":{"line":53,"column":63}},"range":[1245,1306],"raw":"- There would be no clear interop story for CommonJS modules."}],"loc":{"start":{"line":51,"column":2},"end":{"line":54,"column":2}},"range":[1150,1309],"raw":"- Top-level await could block execution.\n> - Top-level await could block fetching resources.\n> - There would be no clear interop story for CommonJS modules.\n> "},{"type":"Paragraph","children":[{"type":"Str","value":"The stage 3 version of the proposal directly addresses these issues:","loc":{"start":{"line":55,"column":2},"end":{"line":55,"column":70}},"range":[1312,1380],"raw":"The stage 3 version of the proposal directly addresses these issues:"}],"loc":{"start":{"line":55,"column":2},"end":{"line":55,"column":70}},"range":[1312,1380],"raw":"The stage 3 version of the proposal directly addresses these issues:"},{"type":"List","ordered":false,"start":null,"spread":false,"children":[{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Strong","children":[{"type":"Str","value":"As siblings are able to execute","loc":{"start":{"line":57,"column":6},"end":{"line":57,"column":37}},"range":[1390,1421],"raw":"As siblings are able to execute"}],"loc":{"start":{"line":57,"column":4},"end":{"line":57,"column":39}},"range":[1388,1423],"raw":"**As siblings are able to execute**"},{"type":"Str","value":", there is no definitive blocking.","loc":{"start":{"line":57,"column":39},"end":{"line":57,"column":73}},"range":[1423,1457],"raw":", there is no definitive blocking."}],"loc":{"start":{"line":57,"column":4},"end":{"line":57,"column":73}},"range":[1388,1457],"raw":"**As siblings are able to execute**, there is no definitive blocking."}],"loc":{"start":{"line":57,"column":2},"end":{"line":57,"column":73}},"range":[1386,1457],"raw":"- **As siblings are able to execute**, there is no definitive blocking."},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Strong","children":[{"type":"Str","value":"Top-level await occurs during the execution phase of the module graph","loc":{"start":{"line":58,"column":6},"end":{"line":58,"column":75}},"range":[1464,1533],"raw":"Top-level await occurs during the execution phase of the module graph"}],"loc":{"start":{"line":58,"column":4},"end":{"line":58,"column":77}},"range":[1462,1535],"raw":"**Top-level await occurs during the execution phase of the module graph**"},{"type":"Str","value":". At this point all resources have already been fetched and linked. There is no risk of blocking fetching resources.","loc":{"start":{"line":58,"column":77},"end":{"line":58,"column":193}},"range":[1535,1651],"raw":". At this point all resources have already been fetched and linked. There is no risk of blocking fetching resources."}],"loc":{"start":{"line":58,"column":4},"end":{"line":58,"column":193}},"range":[1462,1651],"raw":"**Top-level await occurs during the execution phase of the module graph**. At this point all resources have already been fetched and linked. There is no risk of blocking fetching resources."}],"loc":{"start":{"line":58,"column":2},"end":{"line":58,"column":193}},"range":[1460,1651],"raw":"- **Top-level await occurs during the execution phase of the module graph**. At this point all resources have already been fetched and linked. There is no risk of blocking fetching resources."},{"type":"ListItem","spread":false,"checked":null,"children":[{"type":"Paragraph","children":[{"type":"Strong","children":[{"type":"Str","value":"Top-level await is limited to [ESM] modules","loc":{"start":{"line":59,"column":6},"end":{"line":59,"column":49}},"range":[1658,1701],"raw":"Top-level await is limited to [ESM] modules"}],"loc":{"start":{"line":59,"column":4},"end":{"line":59,"column":51}},"range":[1656,1703],"raw":"**Top-level await is limited to [ESM] modules**"},{"type":"Str","value":". There is explicitly no support for scripts or for CommonJS modules.","loc":{"start":{"line":59,"column":51},"end":{"line":59,"column":120}},"range":[1703,1772],"raw":". There is explicitly no support for scripts or for CommonJS modules."}],"loc":{"start":{"line":59,"column":4},"end":{"line":59,"column":120}},"range":[1656,1772],"raw":"**Top-level await is limited to [ESM] modules**. There is explicitly no support for scripts or for CommonJS modules."}],"loc":{"start":{"line":59,"column":2},"end":{"line":59,"column":120}},"range":[1654,1772],"raw":"- **Top-level await is limited to [ESM] modules**. There is explicitly no support for scripts or for CommonJS modules."}],"loc":{"start":{"line":57,"column":2},"end":{"line":59,"column":120}},"range":[1386,1772],"raw":"- **As siblings are able to execute**, there is no definitive blocking.\n> - **Top-level await occurs during the execution phase of the module graph**. At this point all resources have already been fetched and linked. There is no risk of blocking fetching resources.\n> - **Top-level await is limited to [ESM] modules**. There is explicitly no support for scripts or for CommonJS modules."}],"loc":{"start":{"line":49,"column":0},"end":{"line":59,"column":120}},"range":[927,1772],"raw":"> Perhaps you have seen the infamous gist by Rich Harris which initially outlined a number of concerns about top-level await and urged the JavaScript language not to implement the feature. Some specific concerns were:\n> \n> - Top-level await could block execution.\n> - Top-level await could block fetching resources.\n> - There would be no clear interop story for CommonJS modules.\n> \n> The stage 3 version of the proposal directly addresses these issues:\n> \n> - **As siblings are able to execute**, there is no definitive blocking.\n> - **Top-level await occurs during the execution phase of the module graph**. At this point all resources have already been fetched and linked. There is no risk of blocking fetching resources.\n> - **Top-level await is limited to [ESM] modules**. There is explicitly no support for scripts or for CommonJS modules."},{"type":"CodeBlock","lang":"jsx","meta":null,"value":"// CommonJS\nconst a = require('a.cjs');\nconst b = require('b.cjs');\n// ESM\nimport { a } from 'a.mjs';\nimport { b } from 'b.mjs';","loc":{"start":{"line":61,"column":0},"end":{"line":68,"column":3}},"range":[1774,1913],"raw":"```jsx\n// CommonJS\nconst a = require('a.cjs');\nconst b = require('b.cjs');\n// ESM\nimport { a } from 'a.mjs';\nimport { b } from 'b.mjs';\n```"},{"type":"Paragraph","children":[{"type":"Str","value":"ç”±äº CommonJS çš„ require å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œæ‰€ä»¥å¦‚æœ a.cjs å†…æœ‰é¡¶å±‚çš„ await ï¼Œé‚£ä¹ˆ require(â€™b.cjsâ€™) çš„è¯­å¥å°±ä¼šè¢«é˜»å¡ï¼Œå¹¶ä¸” CommonJS æ˜¯åœ¨æ‰§è¡Œåˆ° require çš„æ—¶å€™æ‰ä¼šåŠ è½½å¹¶æ‰§è¡Œå¯¹åº”çš„æ¨¡å—ï¼Œé¡¶å±‚ await ç”šè‡³ä¼šé˜»å¡åˆ° b.cjs èµ„æºçš„åŠ è½½ã€‚","loc":{"start":{"line":70,"column":0},"end":{"line":70,"column":154}},"range":[1915,2069],"raw":"ç”±äº CommonJS çš„ require å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œæ‰€ä»¥å¦‚æœ a.cjs å†…æœ‰é¡¶å±‚çš„ await ï¼Œé‚£ä¹ˆ require(â€™b.cjsâ€™) çš„è¯­å¥å°±ä¼šè¢«é˜»å¡ï¼Œå¹¶ä¸” CommonJS æ˜¯åœ¨æ‰§è¡Œåˆ° require çš„æ—¶å€™æ‰ä¼šåŠ è½½å¹¶æ‰§è¡Œå¯¹åº”çš„æ¨¡å—ï¼Œé¡¶å±‚ await ç”šè‡³ä¼šé˜»å¡åˆ° b.cjs èµ„æºçš„åŠ è½½ã€‚"}],"loc":{"start":{"line":70,"column":0},"end":{"line":70,"column":154}},"range":[1915,2069],"raw":"ç”±äº CommonJS çš„ require å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œæ‰€ä»¥å¦‚æœ a.cjs å†…æœ‰é¡¶å±‚çš„ await ï¼Œé‚£ä¹ˆ require(â€™b.cjsâ€™) çš„è¯­å¥å°±ä¼šè¢«é˜»å¡ï¼Œå¹¶ä¸” CommonJS æ˜¯åœ¨æ‰§è¡Œåˆ° require çš„æ—¶å€™æ‰ä¼šåŠ è½½å¹¶æ‰§è¡Œå¯¹åº”çš„æ¨¡å—ï¼Œé¡¶å±‚ await ç”šè‡³ä¼šé˜»å¡åˆ° b.cjs èµ„æºçš„åŠ è½½ã€‚"},{"type":"Paragraph","children":[{"type":"Str","value":"ä½†æ˜¯åœ¨ ESM ä¸­å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸º import çš„æ„å»ºä¾èµ–å…³ç³»å›¾çš„è¿‡ç¨‹æ˜¯åœ¨ç¼–è¯‘æ—¶å°±ä¼šç¡®å®šå¥½äº†ï¼Œæ­¤æ—¶ä¸ä¼šæ‰§è¡Œæ¨¡å—çš„ä»£ç ã€‚å„ä¸ªæ¨¡å—ä¹Ÿæ˜¯åœ¨ä¸€ä¸ªå¼‚æ­¥çš„å‡½æ•°å†…æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æ¨¡å—æ‰§è¡Œæ—¶ä¹Ÿä¸ä¼šç›¸äº’é˜»å¡ã€‚","loc":{"start":{"line":72,"column":0},"end":{"line":72,"column":97}},"range":[2071,2168],"raw":"ä½†æ˜¯åœ¨ ESM ä¸­å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸º import çš„æ„å»ºä¾èµ–å…³ç³»å›¾çš„è¿‡ç¨‹æ˜¯åœ¨ç¼–è¯‘æ—¶å°±ä¼šç¡®å®šå¥½äº†ï¼Œæ­¤æ—¶ä¸ä¼šæ‰§è¡Œæ¨¡å—çš„ä»£ç ã€‚å„ä¸ªæ¨¡å—ä¹Ÿæ˜¯åœ¨ä¸€ä¸ªå¼‚æ­¥çš„å‡½æ•°å†…æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æ¨¡å—æ‰§è¡Œæ—¶ä¹Ÿä¸ä¼šç›¸äº’é˜»å¡ã€‚"}],"loc":{"start":{"line":72,"column":0},"end":{"line":72,"column":97}},"range":[2071,2168],"raw":"ä½†æ˜¯åœ¨ ESM ä¸­å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸º import çš„æ„å»ºä¾èµ–å…³ç³»å›¾çš„è¿‡ç¨‹æ˜¯åœ¨ç¼–è¯‘æ—¶å°±ä¼šç¡®å®šå¥½äº†ï¼Œæ­¤æ—¶ä¸ä¼šæ‰§è¡Œæ¨¡å—çš„ä»£ç ã€‚å„ä¸ªæ¨¡å—ä¹Ÿæ˜¯åœ¨ä¸€ä¸ªå¼‚æ­¥çš„å‡½æ•°å†…æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æ¨¡å—æ‰§è¡Œæ—¶ä¹Ÿä¸ä¼šç›¸äº’é˜»å¡ã€‚"}],"loc":{"start":{"line":1,"column":0},"end":{"line":72,"column":97}},"range":[0,2168],"raw":"# ESM(import/export)\n\nTags: exports, import\n\n## æ¦‚è¿°\n\nåœ¨ ES6 ä¸­ï¼Œå¼•å…¥äº†ä¸€å¥—æ–°çš„æ¨¡å—åŒ–è§„èŒƒï¼Œä»è¯­è¨€å±‚é¢å®ç°äº†æ¨¡å—åŠŸèƒ½ï¼Œé‚£å°±æ˜¯ ESMã€‚\n\nESM æ¨¡å—çš„ import è¯­å¥ï¼Œ**æ˜¯é™æ€è§£æçš„ï¼Œåœ¨ç¼–è¯‘æ—¶ï¼Œå°±ä¼šè§£æå¹¶åŠ è½½å¯¹åº”çš„æ¨¡å—**ã€‚æ‰€ä»¥ä½¿ç”¨ ESM æ—¶ï¼Œimport è¯­å¥éœ€è¦åœ¨æ–‡ä»¶çš„é¡¶å±‚ã€‚\n\n## åŠ è½½è¿‡ç¨‹\n\nåœ¨ ESM ä¸­ï¼Œæ¨¡å—çš„åŠ è½½æ˜¯**å¼‚æ­¥æ‰§è¡Œ**çš„ã€‚åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œæ‰€æœ‰ä½¿ç”¨åˆ° import å’Œ export å…³é”®å­—çš„è¯­å¥éƒ½ä¼šè¢«è§£æï¼Œç”¨æ¥æ„å»º**ä¾èµ–å…³ç³»å›¾**ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œè¢«å¼•å…¥çš„è„šæœ¬å¹¶ä¸ä¼šç«‹å³æ‰§è¡Œã€‚\n\nESM æ¨¡å—åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œä¸éœ€è¦å®é™…æ‰§è¡Œè¢«å¼•å…¥çš„æ–‡ä»¶çš„ä»£ç ï¼Œä¸€äº› named import å†…çš„é”™è¯¯å°±å¯ä»¥è¢«å‘ç°ã€‚\n\nESM æ¨¡å—åœ¨åŠ è½½çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä»å…¥å£æ–‡ä»¶å¼€å§‹ï¼Œæ ¹æ® import å…³é”®å­—è¯­å¥ï¼Œç”±å¤–åˆ°å†…æ„å»ºæ¨¡å—ä¹‹é—´çš„**ä¾èµ–å…³ç³»å›¾ï¼Œ**ç›´åˆ°æ²¡æœ‰ä»»ä½•å…¶ä»–ä¾èµ–çš„æ¨¡å—ã€‚ç„¶åç”±å†…å‘å¤–æ‰§è¡Œï¼Œä¸€ä¸ªæ¨¡å—ä¾èµ–çš„å…¶ä»–æ¨¡å—éƒ½æ‰§è¡Œå®Œæˆä»¥åï¼Œè¿™ä¸ªæ¨¡å—æ‰èƒ½å¾—åˆ°æ‰§è¡Œã€‚\n\n## ç‰¹ç‚¹\n\n### 1. ESM å¯¼å…¥å’Œå¯¼å‡ºæ˜¯å¼•ç”¨ä¼ é€’\n\né€šè¿‡ export å¯¼å‡ºå€¼ï¼Œé€šè¿‡ import å¯¼å…¥ï¼Œ**è¿™ä¸¤ä¸ªæ˜¯å…³é”®å­—ï¼Œ**ä¸”ä½¿ç”¨ export å¯¼å‡ºçš„å€¼æ˜¯å¼•ç”¨ä¼ é€’ï¼ˆä¸¤ä¸ªæ ‡è¯†ç¬¦æŒ‡å‘çš„æ˜¯åŒä¸€å—å†…å­˜ï¼‰\n\n```jsx\n// a.js\nexport let a = 1;\nexport function changeA(v) {\n\ta = v;\n}\n\n// b.js\nimport { a, changeA } from 'a';\nconsole.log(a);\nchangeA(2);\nconsole.log(a);\n\n// è¾“å‡º\n// 1\n// 2\n```\n\n### 2. ESM æ¨¡å—å†…æ”¯æŒ Top Level Await\n\nå¾—ç›Šäº esm æ¨¡å—çš„åŠ è½½æœºåˆ¶ï¼Œæ¨¡å—çš„æ‰§è¡Œå‘ç”Ÿåœ¨ä¾èµ–å…³ç³»å›¾æ„å»ºå®Œæˆä»¥åï¼Œåœ¨ esm æ¨¡å—å†…ï¼Œå¯ä»¥åœ¨æ¨¡å—çš„é¡¶å±‚ä½¿ç”¨ await å…³é”®å­—ã€‚\n\nä¸‹é¢æ˜¯ä¸€æ®µå¼•ç”¨è‡ª v8 åšå®¢([Top-level await](https://v8.dev/features/top-level-await))çš„ä¸€æ®µï¼š\n\n> Perhaps you have seen the infamous gist by Rich Harris which initially outlined a number of concerns about top-level await and urged the JavaScript language not to implement the feature. Some specific concerns were:\n> \n> - Top-level await could block execution.\n> - Top-level await could block fetching resources.\n> - There would be no clear interop story for CommonJS modules.\n> \n> The stage 3 version of the proposal directly addresses these issues:\n> \n> - **As siblings are able to execute**, there is no definitive blocking.\n> - **Top-level await occurs during the execution phase of the module graph**. At this point all resources have already been fetched and linked. There is no risk of blocking fetching resources.\n> - **Top-level await is limited to [ESM] modules**. There is explicitly no support for scripts or for CommonJS modules.\n\n```jsx\n// CommonJS\nconst a = require('a.cjs');\nconst b = require('b.cjs');\n// ESM\nimport { a } from 'a.mjs';\nimport { b } from 'b.mjs';\n```\n\nç”±äº CommonJS çš„ require å‡½æ•°æ˜¯åŒæ­¥æ‰§è¡Œçš„ï¼Œæ‰€ä»¥å¦‚æœ a.cjs å†…æœ‰é¡¶å±‚çš„ await ï¼Œé‚£ä¹ˆ require(â€™b.cjsâ€™) çš„è¯­å¥å°±ä¼šè¢«é˜»å¡ï¼Œå¹¶ä¸” CommonJS æ˜¯åœ¨æ‰§è¡Œåˆ° require çš„æ—¶å€™æ‰ä¼šåŠ è½½å¹¶æ‰§è¡Œå¯¹åº”çš„æ¨¡å—ï¼Œé¡¶å±‚ await ç”šè‡³ä¼šé˜»å¡åˆ° b.cjs èµ„æºçš„åŠ è½½ã€‚\n\nä½†æ˜¯åœ¨ ESM ä¸­å°±ä¸ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸º import çš„æ„å»ºä¾èµ–å…³ç³»å›¾çš„è¿‡ç¨‹æ˜¯åœ¨ç¼–è¯‘æ—¶å°±ä¼šç¡®å®šå¥½äº†ï¼Œæ­¤æ—¶ä¸ä¼šæ‰§è¡Œæ¨¡å—çš„ä»£ç ã€‚å„ä¸ªæ¨¡å—ä¹Ÿæ˜¯åœ¨ä¸€ä¸ªå¼‚æ­¥çš„å‡½æ•°å†…æ‰§è¡Œçš„ï¼Œæ‰€ä»¥æ¨¡å—æ‰§è¡Œæ—¶ä¹Ÿä¸ä¼šç›¸äº’é˜»å¡ã€‚"},"catalogue":{"title":"ESM(import export)","json-path":"å‰ç«¯å·¥ç¨‹åŒ–/JSæ¨¡å—åŒ–/æ¨¡å—åŒ–è§„èŒƒ 819d6c57d4154f94bdf0781db857fdb7/æ¨¡å—åŒ–è§„èŒƒ 0976128fbb0648a791aca022b8a2f01b/ESM(import export) 3804676a20cb4fbaad218fcce635ab01.json","cover":"https://i.328888.xyz/2023/01/01/tZLcw.jpeg","icon":"ğŸ»","tags":["æ— æ ‡ç­¾"],"visible":false}}